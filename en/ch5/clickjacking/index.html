<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ch5/clickjacking" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">What You See Is Not What You Get: Clickjacking | Beyond XSS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" name="twitter:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" property="og:url" content="https://aszx87410.github.io/beyond-xss/en/ch5/clickjacking/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="O7SjDEO9AQXbxqBWhtUW0FVahHxSrnweMXJxLICpSz4"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="What You See Is Not What You Get: Clickjacking | Beyond XSS"><meta data-rh="true" name="description" content="This is the beginning of Chapter 5, &quot;Other Interesting Topics&quot;. In this final chapter, we will explore some security topics that are more difficult to categorize and cover a wider range of content."><meta data-rh="true" property="og:description" content="This is the beginning of Chapter 5, &quot;Other Interesting Topics&quot;. In this final chapter, we will explore some security topics that are more difficult to categorize and cover a wider range of content."><link data-rh="true" rel="icon" href="/beyond-xss/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://aszx87410.github.io/beyond-xss/en/ch5/clickjacking/"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/en/ch5/clickjacking/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch5/clickjacking/" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch5/clickjacking/" hreflang="x-default"><link rel="stylesheet" href="/beyond-xss/en/assets/css/styles.32fcb3bb.css">
<link rel="preload" href="/beyond-xss/en/assets/js/runtime~main.9a9bfab3.js" as="script">
<link rel="preload" href="/beyond-xss/en/assets/js/main.3d2d1fa0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/beyond-xss/en/"><div class="navbar__logo"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Beyond XSS: Explore the Web Front-end Security Universe</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/beyond-xss/en/ch5/clickjacking/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/beyond-xss/ch5/clickjacking/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">中文（台灣）</a></li></ul></div><a href="https://github.com/aszx87410/beyond-xss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/">About This Series</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/beyond-xss/en/ch1/browser-security-model/">Chapter 1: Starting with XSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/beyond-xss/en/ch2/xss-defense-sanitization/">Chapter 2: Defense and bypass for XSS </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/beyond-xss/en/ch3/attack-without-js/">Chapter 3: Attacks without JavaScript  </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/beyond-xss/en/ch4/sop-and-site/">Chapter 4: Cross-site attacks </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/beyond-xss/en/ch5/clickjacking/">Chapter 5: Other interesting topics  </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/beyond-xss/en/ch5/clickjacking/">What You See Is Not What You Get: Clickjacking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/mime-sniffing/">Exploiting MIME Sniffing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/supply-chain-attack/">Frontend Supply Chain Attacks: Attacking Downstream from Upstream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/web3-attacks/">Web Frontend Attacks in Web3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-1/">The Most Interesting Frontend Side-Channel Attack: XSLeaks (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-2/">The Most Interesting Frontend Side Channel Attack: XSLeaks (Part 2)</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/summary/">Conclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/contact/">Contact the Author</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/beyond-xss/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Chapter 5: Other interesting topics  </span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">What You See Is Not What You Get: Clickjacking</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>What You See Is Not What You Get: Clickjacking</h1><p>This is the beginning of Chapter 5, &quot;Other Interesting Topics&quot;. In this final chapter, we will explore some security topics that are more difficult to categorize and cover a wider range of content.</p><p>First, let&#x27;s take a look at clickjacking. Clickjacking is when you think you are clicking on something from Website A, but in reality, you are clicking on something from Website B. Your click is &quot;hijacked&quot; from Website A to Website B.</p><p>What harm can a simple click do?</p><p>Let&#x27;s say the page behind it is a bank transfer page, and your account number and amount are already filled in. All it takes is one button click to transfer money out. This can be very dangerous (this is just an example, but it illustrates why a second layer of verification is needed for transfers).</p><p>Or let&#x27;s take a more common example. Suppose there is a page that appears to be a cancellation page for a newsletter subscription. So you click the &quot;Confirm Cancellation&quot; button, but underneath it is actually a Facebook &quot;Like&quot; button. So not only did you not cancel the subscription, but you also inadvertently liked something. This type of attack is also known as likejacking.</p><p>Now, let&#x27;s dive deeper into this attack method!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clickjacking-attack-principle">Clickjacking Attack Principle<a href="#clickjacking-attack-principle" class="hash-link" aria-label="Direct link to Clickjacking Attack Principle" title="Direct link to Clickjacking Attack Principle">​</a></h2><p>The principle of clickjacking is to overlay two web pages, where the user sees Website A but clicks on Website B.</p><p>In more technical terms, this is achieved by embedding Website B using an iframe with a transparency of 0.001, and then overlaying it with the content of Website A using CSS.</p><p>I find it most interesting and straightforward to understand clickjacking through examples. Please refer to the GIF below:</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/27-01-dd038d04ad93f1e61f65bd9158aaf49b.gif" width="399" height="219" class="img_ev3q"></p><p>I thought I clicked Yes and unsubscribe the email, but in reality, I clicked &quot;Delete Account.&quot; This is clickjacking. If you want to experience it yourself, you can try it on this webpage: <a href="https://aszx87410.github.io/demo/clickjacking-en/" target="_blank" rel="noopener noreferrer">clickjacking example</a>.</p><p>Some people may find this example too simple, and in actual applications, such simple attacks that only require one button click may be rare. Perhaps more websites will be more complex, requiring the user to enter some information first?</p><p>In the following example, clickjacking is designed for the &quot;Change Email&quot; feature. Unlike the previous example where the entire webpage is covered, this example intentionally leaves the input of the original webpage and overlays everything else with CSS. The button part uses <code>pointer-events:none</code> to allow events to pass through.</p><p>It appears to be a webpage for entering email subscription information, but after clicking &quot;Confirm,&quot; it pops up with &quot;Email Change Successful&quot; because behind it is actually a webpage for changing the email:</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/27-02-b1e29959a3a1cd254777fcbfbb572a28.gif" width="391" height="366" class="img_ev3q"></p><p>A webpage version that you can interact with is also available: <a href="https://aszx87410.github.io/demo/clickjacking-en/adv.html" target="_blank" rel="noopener noreferrer">Advanced clickjacking example</a>.</p><p>The process of clickjacking attack can be summarized as follows:</p><ol><li>Embed the target webpage into a malicious webpage (using iframes or similar tags).</li><li>Use CSS on the malicious webpage to overlay the target webpage, making it invisible to the user.</li><li>Redirect the user to the malicious webpage and prompt them to perform actions (such as input or clicks).</li><li>Trigger the behavior of the target webpage to achieve the attack.</li></ol><p>Therefore, the difficulty of the attack depends on how well the malicious website is designed and how much interaction the target webpage requires. For example, clicking a button is much easier than entering information.</p><p>Also, it is worth noting that to carry out this type of attack, the user must already be logged into the target website. As long as the target webpage can be embedded into a malicious webpage, there is a risk of clickjacking.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defense-against-clickjacking">Defense against Clickjacking<a href="#defense-against-clickjacking" class="hash-link" aria-label="Direct link to Defense against Clickjacking" title="Direct link to Defense against Clickjacking">​</a></h2><p>As mentioned earlier, if a webpage cannot be embedded into another webpage, there is no risk of clickjacking. This is the fundamental solution to clickjacking.</p><p>Generally, there are two types of defense against clickjacking. One is to use JavaScript to check, and the other is to inform the browser through response headers whether the webpage can be embedded.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="frame-busting">Frame busting<a href="#frame-busting" class="hash-link" aria-label="Direct link to Frame busting" title="Direct link to Frame busting">​</a></h3><p>One method called frame busting is to use JavaScript to check, as I mentioned earlier. The principle is simple, and the code is straightforward:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">top </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  top</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">location</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Each webpage has its own window object, and <code>window.self</code> refers to its own window. <code>top</code> refers to the top window, which can be thought of as the top-level window of the entire browser &quot;tab.&quot;</p><p>If a webpage is opened independently, <code>top</code> and <code>self</code> will point to the same window. However, if the webpage is embedded in an iframe, <code>top</code> will refer to the window that uses the iframe.</p><p>Let&#x27;s take an example. Suppose I have an index.html on localhost, which contains the following code:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://example.com</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://huli.tw</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The relationship diagram would look like this:</p><p><img loading="lazy" alt="Window Relationship Diagram" src="/beyond-xss/en/assets/images/27-03-7dc26cf7765c47dfc96d4ebbd85d8527.png" width="1068" height="721" class="img_ev3q"></p><p>The green and yellow represent two web pages loaded in iframes, which are two different windows. If you access <code>top</code> within these web pages, it will refer to the window object of <code>localhost/index.html</code>.</p><p>Therefore, by checking <code>if (top !== self)</code>, you can determine if the web page is being placed inside an iframe. If it is, you can change <code>top.location</code> to redirect the top-level web page elsewhere.</p><p>This sounds great and seems to have no issues, but it can be bypassed by the <code>sandbox</code> attribute of iframes. </p><p>An iframe has an attribute called <code>sandbox</code>, which restricts the functionality of the iframe. If you want to remove the restrictions, you must explicitly specify them. There are many possible values, but I&#x27;ll list a few:</p><ol><li><code>allow-forms</code> - Allows form submission.</li><li><code>allow-scripts</code> - Allows JavaScript execution.</li><li><code>allow-top-navigation</code> - Allows changing the top location.</li><li><code>allow-popups</code> - Allows pop-up windows.</li></ol><p>In other words, if I load the iframe like this:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./busting.html</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">sandbox</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">allow-forms</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Even if <code>busting.html</code> has the protection I mentioned earlier, it won&#x27;t work because it doesn&#x27;t have <code>allow-scripts</code>, so JavaScript cannot be executed. However, users can still submit forms normally.</p><p>Therefore, someone came up with a more practical approach, making some improvements to the existing method (code taken from: <a href="https://en.wikipedia.org/wiki/Framekiller" target="_blank" rel="noopener noreferrer">Wikipedia - Framekiller</a>):</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">style</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token style language-css selector" style="color:#00009f">html</span><span class="token style language-css punctuation" style="color:#393A34">{</span><span class="token style language-css property" style="color:#36acaa">display</span><span class="token style language-css punctuation" style="color:#393A34">:</span><span class="token style language-css">none</span><span class="token style language-css punctuation" style="color:#393A34">;</span><span class="token style language-css punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">style</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">   </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">if</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">self </span><span class="token script language-javascript operator" style="color:#393A34">==</span><span class="token script language-javascript"> top</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">       </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">documentElement</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">style</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">display</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&#x27;block&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">   </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">else</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">       top</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">location</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> self</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">location</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">   </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>First, hide the entire web page, which can only be opened by executing JavaScript. So, if you block script execution with the sandbox mentioned above, you will only see a blank page. If you don&#x27;t use the sandbox, the JavaScript check will fail, and you will still see a blank page.</p><p>Although this can achieve more comprehensive defense, there are also drawbacks. The drawback is that if users voluntarily disable JavaScript, they won&#x27;t see anything. So, for users who disable JavaScript, the experience is quite poor.</p><p>When clickjacking first emerged in 2008, there were no such complete defense methods, so we had to use these workaround-like solutions. Now, browsers have better ways to block web pages from being embedded.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="x-frame-options">X-Frame-Options<a href="#x-frame-options" class="hash-link" aria-label="Direct link to X-Frame-Options" title="Direct link to X-Frame-Options">​</a></h3><p>This HTTP response header was first implemented by IE8 in 2009, and other browsers followed suit. It became a complete <a href="https://www.rfc-editor.org/rfc/rfc7034.txt" target="_blank" rel="noopener noreferrer">RFC7034</a> in 2013.</p><p>This header can have the following three values:</p><ol><li><code>DENY</code></li><li><code>SAMEORIGIN</code></li><li><code>ALLOW-FROM https://example.com/</code></li></ol><p>The first value rejects any web page from embedding this web page, including <code>&lt;iframe&gt;</code>, <code>&lt;frame&gt;</code>, <code>&lt;object&gt;</code>, <code>&lt;applet&gt;</code>, or <code>&lt;embed&gt;</code> tags.</p><p>The second value allows only same-origin web pages, and the last value allows embedding only from specific origins. Other than that, no embedding is allowed (only one value can be specified, so if multiple origins are required, they need to be dynamically adjusted on the server, similar to CORS headers).</p><p>The RFC specifically mentions that the determination of the last two values may differ from what you expect, and each browser&#x27;s implementation may vary.</p><p>For example, some browsers may only check the &quot;parent&quot; and &quot;top&quot; layers, rather than checking every layer. What does &quot;layer&quot; mean? Because theoretically, an iframe can have an infinite number of layers, such as A embedding B embedding C embedding D, and so on.</p><p>If we represent this relationship in text, it would look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com/A.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--&gt; attacker.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --&gt; example.com/B.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --&gt; example.com/target.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For the innermost <code>target.html</code>, if the browser only checks the parent layer (B.html) and the top layer (A.html), then even if it is set to <code>X-Frame-Options: SAMEORIGIN</code>, the check will pass because these two layers are indeed the same origin. However, in reality, there is a malicious web page sandwiched in between, so there is still a risk of being attacked.</p><p>In addition, there is a second issue with <code>X-Frame-Options</code>, which is the poor support for <code>ALLOW-FROM</code>. As of now, in 2023, mainstream browsers do not support the <code>ALLOW-FROM</code> directive.</p><p>The initial <code>X</code> in <code>X-Frame-Options</code> indicates that it is more like a transitional solution. In modern browsers, its functionality has been replaced by Content Security Policy (CSP), which also addresses the aforementioned issues.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="csp-frame-ancestors">CSP: frame-ancestors<a href="#csp-frame-ancestors" class="hash-link" aria-label="Direct link to CSP: frame-ancestors" title="Direct link to CSP: frame-ancestors">​</a></h3><p>CSP has a directive called <code>frame-ancestors</code>, which can be set as follows:</p><ol><li><code>frame-ancestors &#x27;none&#x27;</code></li><li><code>frame-ancestors &#x27;self&#x27;</code></li><li><code>frame-ancestors https://a.example.com https://b.example.com</code></li></ol><p>These three options correspond to the previous <code>X-Frame-Options</code> directives: <code>DENY</code>, <code>SAMEORIGIN</code>, and <code>ALLOW-FROM</code> (with support for multiple origins this time).</p><p>Let&#x27;s clarify a potential confusion: the behavior restricted by <code>frame-ancestors</code> is the same as that of <code>X-Frame-Options</code>, which is &quot;which web pages can embed me using an iframe.&quot; On the other hand, the CSP rule <code>frame-src</code> determines &quot;which sources can be loaded on my web page.&quot;</p><p>For example, if I set <code>frame-src: &#x27;none&#x27;</code> in index.html, any web page loaded within an iframe in index.html will be blocked, regardless of its own settings.</p><p>Another example: if my index.html is set to <code>frame-src: https://example.com</code>, but example.com has <code>frame-ancestors: &#x27;none&#x27;</code> set, index.html still cannot load example.com within an iframe because it is rejected by the other side.</p><p>In summary, for an iframe to be successfully displayed, both parties must agree; if either party disagrees, it will fail.</p><p>Additionally, it is worth noting that <code>frame-ancestors</code> is a rule supported only in CSP level 2, gradually adopted by mainstream browsers starting from the end of 2014.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defense-summary">Defense Summary<a href="#defense-summary" class="hash-link" aria-label="Direct link to Defense Summary" title="Direct link to Defense Summary">​</a></h3><p>Due to varying levels of support, it is recommended to use both <code>X-Frame-Options</code> and CSP&#x27;s <code>frame-ancestors</code>. If you do not want your web page to be loaded within an iframe, remember to add the following HTTP response headers:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X-Frame-Options: DENY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: frame-ancestors &#x27;none&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you only allow same-origin loading, set it as:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X-Frame-Options: SAMEORIGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: frame-ancestors &#x27;self&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you want to specify an allow list of sources, use:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X-Frame-Options: ALLOW-FROM https://example.com/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: frame-ancestors https://example.com/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, there is another defense mechanism that browsers have already implemented. Can you recall what it is?</p><p>It is the default <code>SameSite=Lax</code> cookie! With this, web pages embedded within iframes will not send cookies to the server, thus not meeting the prerequisite for clickjacking attacks, which is &quot;the user must be logged in.&quot; From this perspective, in addition to CSRF mentioned earlier, same-site cookies also address many other security issues.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-examples">Real-world Examples<a href="#real-world-examples" class="hash-link" aria-label="Direct link to Real-world Examples" title="Direct link to Real-world Examples">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="yelp">Yelp<a href="#yelp" class="hash-link" aria-label="Direct link to Yelp" title="Direct link to Yelp">​</a></h3><p>In 2018, hk755a reported two clickjacking vulnerabilities to Yelp, the largest restaurant review website in the United States. The vulnerabilities were titled: <a href="https://hackerone.com/reports/305128" target="_blank" rel="noopener noreferrer">ClickJacking on IMPORTANT Functions of Yelp</a> and <a href="https://hackerone.com/reports/355859" target="_blank" rel="noopener noreferrer">CRITICAL-CLICKJACKING at Yelp Reservations Resulting in exposure of victim Private Data (Email info) + Victim Credit Card MissUse.</a>.</p><p>One of the reports discussed the reservation page of a restaurant. After entering the page, the user&#x27;s personal information is automatically filled in, and they can successfully make a reservation by clicking a button. Therefore, the target of clickjacking is this reservation button.</p><p>What are the consequences if the user unknowingly clicks the reservation button? First, the attacker can register a restaurant and:</p><ol><li>See the information of the people who made the reservation and steal their email addresses.</li><li>To cancel a reservation, a cancellation fee must be paid. The attacker can collect the money.</li></ol><p>Even without registering a restaurant, it is still possible to attack. For example, if I dislike a certain restaurant, I can intentionally share their reservation page and create many fake reservations, making it difficult for the restaurant to distinguish between genuine and fake bookings.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="twitter">Twitter<a href="#twitter" class="hash-link" aria-label="Direct link to Twitter" title="Direct link to Twitter">​</a></h3><p>Let&#x27;s first look at the vulnerability reported by filedescriptor to Twitter in 2015: <a href="https://hackerone.com/reports/85624" target="_blank" rel="noopener noreferrer">Highly wormable clickjacking in player card</a>.</p><p>This vulnerability is quite interesting and exploits the browser implementation issues mentioned earlier.</p><p>In this case, Twitter had already set <code>X-Frame-Options: SAMEORIGIN</code> and <code>Content-Security-Policy: frame-ancestors &#x27;self&#x27;</code>. However, during the implementation check in some browsers, only the top window was checked for compliance.</p><p>In other words, if it was twitter.com =&gt; attacker.com =&gt; twitter.com, it would pass the check, allowing malicious web pages to be embedded.</p><p>Furthermore, this vulnerability occurred in Twitter&#x27;s timeline, so it could achieve a worm-like effect. After clickjacking, it would send tweets, which would be seen by more people, resulting in more people sending the same tweets.</p><p>The author&#x27;s writeup is excellent, but the blog is down. Here is an archive: <a href="http://web.archive.org/web/20190310161937/https://blog.innerht.ml/google-yolo/" target="_blank" rel="noopener noreferrer">Google YOLO</a></p><p>Another report was submitted by eo420 to Periscope, a subsidiary of Twitter, in 2019: <a href="https://hackerone.com/reports/591432" target="_blank" rel="noopener noreferrer">Twitter Periscope Clickjacking Vulnerability</a>.</p><p>This bug was due to compatibility issues. The web page only set <code>X-Frame-Options: ALLOW-FROM</code> without setting CSP, which is not effective because modern browsers do not support <code>ALLOW-FROM</code>. The impact it can cause is that there is a &quot;Deactivate Account&quot; button on the website, which can mislead users into clicking it without their knowledge.</p><p>The solution is simple, just use the <code>frame-ancestors</code> CSP that is supported by current browsers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tumblr">Tumblr<a href="#tumblr" class="hash-link" aria-label="Direct link to Tumblr" title="Direct link to Tumblr">​</a></h3><p>In 2020, fuzzme reported a vulnerability to Tumblr: <a href="https://hackerone.com/reports/953579" target="_blank" rel="noopener noreferrer">[api.tumblr.com] Exploiting clickjacking vulnerability to trigger self DOM-based XSS</a>.</p><p>I specifically chose this case because it is a chain of attacks!</p><p>Previously, there was a type of vulnerability called self-XSS, where only the user could trigger XSS. Therefore, many bug bounty programs do not accept this type of vulnerability because it has little impact.</p><p>This report combines self-XSS with clickjacking, allowing users to trigger self XSS through clickjacking, making the attack easier to achieve and more feasible.</p><p>How does this chaining work?</p><p>First, the user is prompted to click a button, secretly copying the XSS payload in the background. Then, the user is asked to paste it into another input field and click another button. That input field is actually the username field, and the final button is &quot;Update Data&quot;. By following the instructions, the user unknowingly changes their username to the XSS payload.</p><p>These are some practical examples related to clickjacking. It is worth noting that some issues are caused by compatibility problems rather than misconfigurations, so correct configuration is also important.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unpreventable-clickjacking">Unpreventable Clickjacking?<a href="#unpreventable-clickjacking" class="hash-link" aria-label="Direct link to Unpreventable Clickjacking?" title="Direct link to Unpreventable Clickjacking?">​</a></h2><p>The defense against clickjacking is essentially not allowing others to embed your web page. But what if the purpose of the web page is to allow others to embed it? What should be done in the case of widgets like the Facebook widget, which includes the &quot;Like&quot; and &quot;Share&quot; buttons that are meant to be embedded using iframes?</p><p>According to these two articles:</p><ol><li><a href="https://www.netsparker.com/blog/web-security/clickjacking-attack-on-facebook-how-tiny-attribute-save-corporation/" target="_blank" rel="noopener noreferrer">Clickjacking Attack on Facebook: How a Tiny Attribute Can Save the Corporation</a></li><li><a href="https://stackoverflow.com/questions/61968091/facebook-like-button-click" target="_blank" rel="noopener noreferrer">Facebook like button click</a></li></ol><p>The information obtained inside may currently only reduce user experience a bit in exchange for security. For example, after clicking a button, a popup will appear for confirmation, which adds an extra click for the user but also avoids the risk of likejacking.</p><p>Alternatively, I speculate that this behavior may also depend on the source of the website. For example, on more reputable websites, this popup may not appear.</p><p>I have created a simple demo webpage: <a href="https://aszx87410.github.io/demo/clickjacking-en/like.html" target="_blank" rel="noopener noreferrer">https://aszx87410.github.io/demo/clickjacking/like.html</a></p><p>If likejacking is successful, clicking the button will like the Facebook Developer Plugin&#x27;s page (I have successfully tested it myself). You can try it out and then click &quot;Show Original page&quot; to see what is under the button, and also unlike the page.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>Compared to the time when browser support was not as complete, we are much better off now. Browsers have implemented more and more security features and new response headers to protect users from malicious attacks.</p><p>Although clickjacking has become increasingly difficult to achieve with the advent of default same-site cookies, it is still important to remember to set the <code>X-Frame-Options</code> and CSP mentioned in the article. After all, that&#x27;s how cybersecurity works, having an extra layer of protection is always good.</p><p>References:</p><ol><li><a href="https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPCLICKJACKING.md" target="_blank" rel="noopener noreferrer">TOPCLICKJACKING.md</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html#x-frame-options-header-types" target="_blank" rel="noopener noreferrer">Clickjacking Defense Cheat Sheet</a></li><li><a href="https://content-security-policy.com/frame-ancestors/" target="_blank" rel="noopener noreferrer">CSP frame-ancestors</a></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/beyond-xss/en/ch4/cookie-bomb/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Interesting and Practical Cookie Bomb</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/beyond-xss/en/ch5/mime-sniffing/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exploiting MIME Sniffing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#clickjacking-attack-principle" class="table-of-contents__link toc-highlight">Clickjacking Attack Principle</a></li><li><a href="#defense-against-clickjacking" class="table-of-contents__link toc-highlight">Defense against Clickjacking</a><ul><li><a href="#frame-busting" class="table-of-contents__link toc-highlight">Frame busting</a></li><li><a href="#x-frame-options" class="table-of-contents__link toc-highlight">X-Frame-Options</a></li><li><a href="#csp-frame-ancestors" class="table-of-contents__link toc-highlight">CSP: frame-ancestors</a></li><li><a href="#defense-summary" class="table-of-contents__link toc-highlight">Defense Summary</a></li></ul></li><li><a href="#real-world-examples" class="table-of-contents__link toc-highlight">Real-world Examples</a><ul><li><a href="#yelp" class="table-of-contents__link toc-highlight">Yelp</a></li><li><a href="#twitter" class="table-of-contents__link toc-highlight">Twitter</a></li><li><a href="#tumblr" class="table-of-contents__link toc-highlight">Tumblr</a></li></ul></li><li><a href="#unpreventable-clickjacking" class="table-of-contents__link toc-highlight">Unpreventable Clickjacking?</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Huli. All rights reserved. Built with Docusaurus.</div></div></div></footer></div>
<script src="/beyond-xss/en/assets/js/runtime~main.9a9bfab3.js"></script>
<script src="/beyond-xss/en/assets/js/main.3d2d1fa0.js"></script>
</body>
</html>