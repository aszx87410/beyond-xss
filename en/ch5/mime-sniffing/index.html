<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ch5/mime-sniffing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Exploiting MIME Sniffing | Beyond XSS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" name="twitter:image" content="https://aszx87410.github.io/beyond-xss/en/img/cover.png"><meta data-rh="true" property="og:url" content="https://aszx87410.github.io/beyond-xss/en/ch5/mime-sniffing/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="O7SjDEO9AQXbxqBWhtUW0FVahHxSrnweMXJxLICpSz4"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Exploiting MIME Sniffing | Beyond XSS"><meta data-rh="true" name="description" content="In every response, there is usually a response header called Content-Type that tells the browser the MIME type of the response, such as text/html or application/json."><meta data-rh="true" property="og:description" content="In every response, there is usually a response header called Content-Type that tells the browser the MIME type of the response, such as text/html or application/json."><link data-rh="true" rel="icon" href="/beyond-xss/en/img/logo.png"><link data-rh="true" rel="canonical" href="https://aszx87410.github.io/beyond-xss/en/ch5/mime-sniffing/"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/en/ch5/mime-sniffing/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch5/mime-sniffing/" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://aszx87410.github.io/beyond-xss/ch5/mime-sniffing/" hreflang="x-default"><link rel="stylesheet" href="/beyond-xss/en/assets/css/styles.32fcb3bb.css">
<link rel="preload" href="/beyond-xss/en/assets/js/runtime~main.f929a1ae.js" as="script">
<link rel="preload" href="/beyond-xss/en/assets/js/main.3cee423b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/beyond-xss/en/"><div class="navbar__logo"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/beyond-xss/en/img/logo.png" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Beyond XSS: Explore the Web Front-end Security Universe</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/beyond-xss/en/ch5/mime-sniffing/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/beyond-xss/ch5/mime-sniffing/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">中文（台灣）</a></li></ul></div><a href="https://github.com/aszx87410/beyond-xss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/">About This Series</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 1: Starting with XSS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/browser-security-model/">Browser Security Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/xss-introduction/">Starting with XSS for Frontend Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/know-xss-a-bit-more/">Understanding XSS a Bit More</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch1/javascript-protocol/">Dangerous javascript: pseudo protocol</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 2: Defense and bypass for XSS </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/xss-defense-sanitization/">The First Line of Defense Against XSS: Sanitization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/xss-defense-csp/">The Second Line of Defense Against XSS: CSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/token-storage/">The Third Line of Defense against XSS: Reducing the Impact Scope</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/trust-types/">Latest XSS Defense: Trusted Types and Built-in Sanitizer API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/csp-bypass/">Bypassing Your Defenses: Common CSP Bypasses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/mutation-xss/">Bypassing Your Defense: Mutation XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch2/universal-xss/">The Most Powerful XSS: Universal XSS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 3: Attacks without JavaScript  </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/attack-without-js/">Who says you have to execute JavaScript directly to attack?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/prototype-pollution/">Prototype Pollution: Exploiting the Prototype Chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/dom-clobbering/">Can HTML affect JavaScript? Introduction to DOM clobbering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/csti/">Template Injection in Frontend: CSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/css-injection/">CSS Injection: Attacking with Just CSS (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/css-injection-2/">CSS Injection: Attacking with Just CSS (Part 2)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch3/html-attack/">Can You Attack with Just HTML?</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Chapter 4: Cross-site attacks </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/sop-and-site/">The Essence: Same-origin Policy and Site</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/cors-intro/">Introduction to Cross-Origin Resource Sharing (CORS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/cors-attack/">Cross-Origin Security Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/csrf/">Cross-Site Request Forgery (CSRF) Made Easy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/same-site-cookie/">Same-site cookie, the savior of CSRF?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/subdomain/">From same-site to main site</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch4/cookie-bomb/">Interesting and Practical Cookie Bomb</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Chapter 5: Other interesting topics  </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/clickjacking/">What You See Is Not What You Get: Clickjacking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/beyond-xss/en/ch5/mime-sniffing/">Exploiting MIME Sniffing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/supply-chain-attack/">Frontend Supply Chain Attacks: Attacking Downstream from Upstream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/web3-attacks/">Web Frontend Attacks in Web3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-1/">The Most Interesting Frontend Side-Channel Attack: XSLeaks (Part 1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/beyond-xss/en/ch5/xsleaks-2/">The Most Interesting Frontend Side Channel Attack: XSLeaks (Part 2)</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/summary/">Conclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/beyond-xss/en/contact/">Contact the Author</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/beyond-xss/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Chapter 5: Other interesting topics  </span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Exploiting MIME Sniffing</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Exploiting MIME Sniffing</h1><p>In every response, there is usually a response header called <code>Content-Type</code> that tells the browser the MIME type of the response, such as <code>text/html</code> or <code>application/json</code>.</p><p>But what if there is no <code>Content-Type</code> header? The browser will try to determine the type based on the file content. Even if the <code>Content-Type</code> header is present, the browser may still interpret it as a different type.</p><p>This behavior of inferring the MIME type from the file content is called MIME sniffing. Let&#x27;s explore this feature together!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mime-sniffing-101">MIME Sniffing 101<a href="#mime-sniffing-101" class="hash-link" aria-label="Direct link to MIME Sniffing 101" title="Direct link to MIME Sniffing 101">​</a></h2><p>We can easily output a response without the <code>Content-Type</code> header using Express:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;h1&gt;hello&lt;/h1&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5555</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Server is running on port 5555&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you open this webpage in a browser, you will see that the text &quot;hello&quot; becomes larger and bold, indicating that the browser renders the response as a webpage:</p><p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAakAAACuCAYAAACMXvJXAAABXGlDQ1BJQ0MgUHJvZmlsZQAAKJFtkE1LAnEQxp81QykLD9EhOngJCrYQlQ7dzNAED4smvUDQupoGvvxbNyK69hmiT9Cpc3aULn0Ao8BjBF0DwQ4l2/PXSq0GhvnxMDM8M4DDqwtRdAIolS0zGVv1bW3v+FwvcGMCk1AQ1I2qCGtagi34rsPRfmAfo7Eod502nuaV5nRLvfW8Rd3X/r/9QzGWzVUN1g/msiFMC1BCZO3YEpLPyFMmTZEvJOd7fCU50+N6t2cjGSHfk71GQc+Sn8lqZkDPD3CpeGR8eZDuPblyOsU6w5xFAjH4EIeGFGsUaSoJrGONf/p/LtSdi6ACgROYOEAeBVicDlMRKCLX3ViGgSWo5AD8zKD89+8/9rVD3rcSBxylvranATev8sy+NqfSyh1Q3xW6qf98V2k7q/vBQI/Ha8DouW23NgHXAtB5tO33mm13LoGRJmfbn5ONY5tkAuSrAAAAVmVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAADkoYABwAAABIAAABEoAIABAAAAAEAAAGpoAMABAAAAAEAAACuAAAAAEFTQ0lJAAAAU2NyZWVuc2hvdICdXxcAAAHWaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjE3NDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj40MjU8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpVc2VyQ29tbWVudD5TY3JlZW5zaG90PC9leGlmOlVzZXJDb21tZW50PgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KqSRyAAAADwNJREFUeAHt3WeoHFUbB/ATDTZQox/UqKjYSxRBBBWxfxUVbNiIKFhQwYIiCjYEEQRRP6gg9oKiqCiCHyxgYkXE2HuP5oPYC2ruu2d9c9+7s7P3bm5u3Of1+Q2E7MyenX3O7xzun9mdmZ21YOHCsWIhQIAAAQIBBWaNdZaAdSmJAAECBAiUVRgQIECAAIGoAkIq6sioiwABAgQcSZkDBAgQIBBXwJFU3LFRGQECBNILCKn0UwAAAQIE4goIqbhjozICBAikFxBS6acAAAIECMQVEFJxx0ZlBAgQSC8gpNJPAQAECBCIKyCk4o6NyggQIJBeQEilnwIACBAgEFdASMUdG5URIEAgvYCQSj8FABAgQCCugJCKOzYqI0CAQHoBIZV+CgAgQIBAXAEhFXdsVEaAAIH0AkIq/RQAQIAAgbgCQiru2KiMAAEC6QWEVPopAIAAAQJxBYRU3LFRGQECBNILCKn0UwAAAQIE4grMHqa0a665pixevLin6bnnnlvmzp3bsy3aysMPP1yee+658bJWXXXVUuveYIMNxrfVB4sWLSq33357z7a99967HHrooT3brBAgQIDAPyswVEjdcccd5fXXX++pbP78+eFD6oEHHij33HNPT9177bVXOeSQQ3q2vfDCC6UG8cRl6dKlQmoiiMcECBAYgYCP+0aA7i0JECBAYDgBITWck1YECBAgMAIBITUCdG9JgAABAsMJCKnhnLQiQIAAgREICKkRoHtLAgQIEBhOQEgN56QVAQIECIxAYKhT0Cer66+//upei/TUU0+VL774ovzyyy9lu+22K9tvv33Zcccdyy677DLZy1uf+/nnn8ubb77ZvX7ptddeK0uWLOle27ThhhuWPffcs9RrmFZfffXW145i45dfflnefvvtbr1vvPFGt4R58+aVnXfeuWuw8cYbj6Is70mAAIH/e4EVCqlXXnmlHHvsseW9994bCHHccceV66+/vsyZM2dgm2VPfPDBB+W8884rjzzyyLJNA/+/8sory9lnn13WXHPNgW1W5hM1nO+9995y4YUXdsN5svfadNNNy9VXX12OPPLIUi8othAgQIDAcALT/rivBsnuu+8+aUDVEu66667uEcVHH300aUWPPvpo2WabbYYKqLqjiy66qOy6665TBsSkbzrNJ3/88cdy8MEHl+OPP36o969HmMccc0z3IuKffvppmu/qZQQIEMgnMO2Quvjii4fWqn+kr7jiioHtn3zyyb67QAxsPOGJegS37777lq+//nrC1pX78I8//igHHnhgeeKJJ5b7jR5//PFywAEHlLoPCwECBAhMLTDtkJq46/qH95xzzul+nNW8L96ydrfddlt59913l62O///rr7+Wk046aXx94oP6nVZ97vTTTy9HH3103z33att6hFY/+vunlvrR5csvv9z6dttuu22pH2/Wf/Vx21Jfe8MNN7Q9ZRsBAgQINAXGhlg6Jz+MdV7X92/ttdceW7BgQc8evvvuu7HOdy99bevrO2HS07au1G1t+77xxhvH/vzzz572nRMqxi699NLW9p9//nlP27rS+Yitr23nprN97W6++ea+dp3vu/raffrpp33tau3V4fnnn+9rX23qc239a6u3bwc2ECBAILnACh1JPfbYY6XesHXisu6665a777671JMFmssnn3zSs+mzzz7rfrfUs7GzUk8yOOWUU/pOMlhrrbXKJZdc0j2yar6meYPY5vMzsV6PFptLJ4TKSy+9VPbYY4/mU12bF198sdQ2zaXejd1CgAABApMLTDuk9ttvv7LPPvu07n327Nnds/SaTzZDqoZcc6nhVs/am2y56qqr+p6+9tpry/fff9+3faY21I8lH3zwwb7ddY7suqfb9z3x3w077LBDufzyy/uevv/++8vvv//et90GAgQIEPifwLRDqn5HNNnSdn3Uhx9+2POSd955p2e9rhx++OGlhtxkSz0yqd+DNZepziBstl+e9Xp6fNty4okntm3u2VbbtB1NNT16XmSFAAECBMq0Q2rzzTeflK/tAtbm6df1gt3mUo+IZs2aNeW/evFwc6kfH66spe1asHo0ud566035lvUj0ObHovVFbSeSTLkzDQgQIJBIYNoh1RZCE93WWWediautjwedJdfaeIiNKzOk2o76tthiiyGq+rvJlltu2de23qXCQoAAAQKDBaYdUqusMu2XdqvpnLlX6kWxM7l8/PHHM7m7nn199dVXPet1ZdDp9n0NB7Stt1OyECBAgMBggcm//Bn8uhV+pn7vVE+SqBf6Npfl+eM/8bU//PDD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" width="425" height="174" class="img_ev3q"></p><p>Now let&#x27;s look at the second example, where we change <code>&lt;h1&gt;</code> to <code>&lt;h2&gt;</code>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;h2&gt;hello&lt;/h2&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5555</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Server is running on port 5555&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAScAAABQCAYAAABbCrOMAAABXGlDQ1BJQ0MgUHJvZmlsZQAAKJFtkE1LAnEQxp81QykLD9EhOngJCrYQlQ7dzNAED4smvUDQupoGvvxbNyK69hmiT9Cpc3aULn0Ao8BjBF0DwQ4l2/PXSq0GhvnxMDM8M4DDqwtRdAIolS0zGVv1bW3v+FwvcGMCk1AQ1I2qCGtagi34rsPRfmAfo7Eod502nuaV5nRLvfW8Rd3X/r/9QzGWzVUN1g/msiFMC1BCZO3YEpLPyFMmTZEvJOd7fCU50+N6t2cjGSHfk71GQc+Sn8lqZkDPD3CpeGR8eZDuPblyOsU6w5xFAjH4EIeGFGsUaSoJrGONf/p/LtSdi6ACgROYOEAeBVicDlMRKCLX3ViGgSWo5AD8zKD89+8/9rVD3rcSBxylvranATev8sy+NqfSyh1Q3xW6qf98V2k7q/vBQI/Ha8DouW23NgHXAtB5tO33mm13LoGRJmfbn5ONY5tkAuSrAAAAVmVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAADkoYABwAAABIAAABEoAIABAAAAAEAAAEnoAMABAAAAAEAAABQAAAAAEFTQ0lJAAAAU2NyZWVuc2hvdHT0PCIAAAHVaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjgwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjI5NTwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlVzZXJDb21tZW50PlNjcmVlbnNob3Q8L2V4aWY6VXNlckNvbW1lbnQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrTZqzKAAALXklEQVR4Ae2daahOXRTHtyGSKUOKRCEflCFSpiQyJXwQiQxRUmYyZigyK0KZQvKBzGSex2uWOVPmmczztN/1X7VPz32Ge12e97bfd/93Pfc5wz77rP1b5/zPXmsfjzzHMjKsYSEBEiABzwjksVI8s4nmkAAJkIDJSwYkQAIk4CMBipOPXqFNJEACHDnxGiABEvCTAEdOfvqFVpFA8AQoTsFfAgRAAn4SoDj56RdaRQLBE6A4BX8JEAAJ+EmA4uSnX2gVCQRPgOIU/CVAACTgJwGKk59+oVUkEDwBilPwlwABkICfBChOfvqFVpFA8AQoTsFfAgRAAn4SoDj56RdaRQLBE6A4BX8JEAAJ+EmA4uSnX2gVCQRPgOIU/CVAACTgJwGKk59++S2rzpw5Y7Zt2/ZbdVmJBP5rBNLyM72nT58269evNyVLljQjRozIlsHz58/NyZMnzcuXL02dOnVMjRo1sj0mvsKzZ8/M3Llzzc+fP83IkSNNiRIl4qvkeH3jxo3mxIkTelzevHnN2LFjTeHChRPamTlzptqOHeXKlTODBg1KqPNvb0C/q1WrZpo0aWIWLVpk8GvL06ZNM2/evDFdunQxNWvWzNIE1Iffrl69quyaNm1qihYtmuUx3EkCuUoAvyH+p+Xbt2966NatW23VqlWtXNzZNrVkyRL8Znmmj4hApuNcu5k2xq3cvn3bNmzYUNuRGyxu75+tzpkzx7Zs2dLWrl1b271//37Shnr27GmbN29uy5cvbytVqpS0zt9u/PHjh8UnVREhVRsvXbqkVVBXREm3LV68ONVhuv3x48dWRE3rwmfwB/py69at6Ljv37/bX79+RetcIIHcJoAnbo4KhGPVqlVWRjv6cQfPnz//t8QJN3Pbtm3t27dv7YcPH2yPHj305jh//rw2dezYMV3v3bu3vXz5sms+6feFCxe0brrEyZ3E2ZBKnFy9qVOnpl2cXr16ZadPn27LlCljhw8f7k6V8F23bl3lGL8DQpOdOMF/qLd9+3Y9XMJDXe/QoUPUHEQaD5ylS5faz58/R9u5QAK5ReC3xendu3d23rx5+oTFhd2tWzd75cqVyE4nThCMoUOH2sGDB9tz585F+93C2bNnLZ7Kruzbt09vjJUrV+omCVcsliVk0e0QskOHDrnqmb6dOGH/xIkTba9evfSGi23fHXDx4kU7fvx426lTJ9u/f3+LkUeqki5xevLkiZ01a5aF0A4YMEBv9C9fviQ9LYRQQmLtM0YzY8aMsRL2Jq178OBBrXfkyJGE/fANfLFw4UIV/mXLlln4LrZI6GevXbsWu0lHoRg9uYKRad++ffU8EEoJGS2Ek4UEcotAtuKEGww3tRv+42l+9+7dBPtwQ+DGwMeFeFjes2dPQt3YDZIv0mPi20RIsWPHDiu5EN2PkYLktTIJmxMnnAf24bxYhr2xRXIyuh11EPq4ehCqZKFLOsRp7969ETOEUO6c+H706FFkHvqAMBF2Qxwkj6ajyqhCkoXWrVvbevXqJdmj/82XtoX2XHiK8DerIjlAPaZPnz4J1eD/CRMmRH0ZNmyYvXfvXkI9biCBdBPIUpw2b94cXegzZszI8snpxAl5GxSMEHCz4embqhw/flzbh2BkVRB2IOTADYcR1cePH7W6E6eOHTvar1+/qtBgRBebB0IeBcdBIGJHVKNHj9btCHHiy9+KE8JVCCFGHDdv3tTmIYK7du3Sc7Zv3163ORtgL+z4nVyb6/OWLVvizdZ1J3JulIOwDNtShahgAn6og9FlqvL+/XsdkbmH1IoVK1JV5XYSSAuBLF8lqFixos4IyYVr5IbVmR0sZ1Xk6au7CxYsaNq1a2dOnTqVtLrkk0yLFi2MPN11tilpJdkoQqQze5jdQ2ncuLFB27FFQkhToEABkydPHiNhoJGQxLx+/VqrSAik38WLFzeTJk0yMgrQD2a1UCQk1O90/sEsmNzMRkI5U6VKFW0atqG/IpJGRN+IEOkspdzsaq8ItXnw4EG2ZkiYaGT0Zdq0aZOybr9+/aLZy1atWmk9EZ6E+nIFqY1r1641Io6mevXqCXXchhs3bpiMjAztl4ipqVy5stvFbxL4VwhkKU6YjpbZICOzcTp13qhRI1O/fn0jT22dwo+3CDdaoUKFos1YT1auX79umjVrZiAYeE+nSJEiCdVevHihYlK2bFmDm02e7kZCP7NgwQKTL1++TPVjXyOIbwuvK6B8+vTJyCgq+khC3kgy3ribN1ODf7kiOR5tAVP98cW9NoHzd+7c2Tx9+lTFecOGDXrDd+3a1UiuLv4wXUf/JR9nZMRl8KpDqlKqVKloV7JXIbATwoRXMCQ3ZfBqBGyJL6gj4amKKl75kDyVWbdunYH/JFSMr851EkgvgZyMvxDuICQRCzSHsmnTpuhwlxCPNsgC8knIe8QWJGIRGiCUcaEGErZu2hwh0ZAhQ/QcqIdEtwhVbBPRsgtxYmfrMAMF+1xYAxuxPnv27Og4t4BQMDbUc9v/NqxDKIdzuvDNtYtZL/QJ4V58gR1r1qzRGVAci1cV4sMscMGxqZLqaBPHxs7WIfmNbXjdI7Y4xpgZdEVGm27RImfmclawBevJ8nPRAVwggTQTSP34lSs6vjRo0MDIzW4QkmEUJXkHrYLRCZ6qCGXcS4zyLo2GK3jh0o0EMFpAWIZ6GCFg1IQnd61atYy8/6RtIXxAqCViZyQZa8aNG2dKly4db4oRYdGXCLED4QbCJBG26FyHDx82cjMZmRLX0FSS5Gby5Ml6DPowcOBAbXfUqFFR20ePHjW7d+82CLFQDhw4oOsyo2hEPHUbRmAYTaAe+owRHpbxQTiHglBOktwavnXv3l3rr169Wkcg6PuUKVO0Xuyf/Pnz6+hQXqkwkpvSkdHOnTujKmAsAmtgb3xY6yq582O0C7vkWlE22C+zpAb8UcAWbWFkV6xYMfWBJLpNhQoVdD/+IMzDfryFjr5hpIvQlIUEco1AOsROQi19OovROjLAExZT4VjHB0lsFDfScdtjvzETl5OC96Jij0fbmN2L3SY5HG1SwiErOZpM+zACQUIaM1UocuNm2h/bDpbv3Lmj9fbv35+yXmwiHkl7l/B2beGcy5cv13Zy+kfyZcoWdiYrGHliVObOhRlKjB7dOr4dY/eyZuw+LGMmkYUEfCGQln++Ihf2f6Jg1CPT+JosRl4mN0YCGHE9fPhQRzvIn/1pkXfHNCeF/BsLCYRAIChxCsGh7CMJ/F8I5Cjn9H/pNPtBAiTgPwGKk/8+ooUkECQBilOQbmenScB/AhQn/31EC0kgSAIUpyDdzk6TgP8EKE7++4gWkkCQBChOQbqdnSYB/wlQnPz3ES0kgSAJUJyCdDs7TQL+E6A4+e8jWkgCQRKgOAXpdnaaBPwnQHHy30e0kASCJEBxCtLt7DQJ+E+A4uS/j2ghCQRJgOIUpNvZaRLwnwDFyX8f0UISCJIAxSlIt7PTJOA/AYqT/z6ihSQQJAGKU5BuZ6dJwH8CFCf/fUQLSSBIAhSnIN3OTpOA/wQoTv77iBaSQJAEKE5Bup2dJgH/CVCc/PcRLSSBIAlQnIJ0OztNAv4ToDj57yNaSAJBEqA4Bel2dpoE/CdAcfLfR7SQBIIkQHEK0u3sNAn4T4Di5L+PaCEJBEmA4hSk29lpEvCfAMXJfx/RQhIIkgDFKUi3s9Mk4D8BipP/PqKFJBAkAYpTkG5np0nAfwIUJ/99RAtJIEgCFKcg3c5Ok4D/BChO/vuIFpJAkAQoTkG6nZ0mAf8JUJz89xEtJIEgCVCcgnQ7O00C/hOgOPnvI1pIAkESoDgF6XZ2mgT8J0Bx8t9HtJAEgiRAcQrS7ew0CfhPgOLkv49oIQkESYDiFKTb2WkS8J/APyDX9qKZXNefAAAAAElFTkSuQmCC" width="295" height="80" class="img_ev3q"></p><p>Wait, why is it suddenly displayed as plain text?</p><p>Next, in the third example, we have the same <code>&lt;h1&gt;</code> but with some additional text:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Hello, &lt;h1&gt;world&lt;/h1&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5555</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Server is running on port 5555&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,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8xUmlnX1//jjD7ez4YYbFvfcc09hD2zd8YG0UTWm5TavvfbaxcEHH1zeVfdb/k+YMKFYfvnl/VN3sLRx1FFHFXPMMUdhPfTS3qIYPXp0sd1229Xta7ahGJrYFscdd5zzNrGsq3b66ae7/RNPPLGwkUPdMTbyJ9DxFbnkkkuGo48+2ns+11xzTRg2bFhYddVVwwILLBA23XRTH0aV37QvvfRSuPHGG73HYA9+0PBq1KhRSd8vGs5dd9113gOdddZZw4orrhi23377MNNMMyW9robYt912m/cC7SUS1l133XD33XeHeeaZp+666kGLiXrk6kGa6NX1TmaeeeZgYuHnzD777HXnakM91UcffTSceuqpYeONNw4mGkG9T9nSsVguueQS761re7311gvrrLOOH1JPSbFTe8VE11LMOnH766+/PL7qASqNsO+++3o75KPSDLvttltYa6214uUrfcumCX545ZVXwoILLuj3R6sTf/zxxzB+/PhwxhlneG9vxx13dL+b1f/uu+88DmKke6BZufPOO8Ott94aFl988bDTTjt5uqNcT/HTZ+LEieXdtd8aAalnqV7/8ccfH/bbbz8f7egZofQAgSrvA3vQ/U1rN2St+l133eX7Pv3009o+e1h9n97uepOPHDnSt8eOHdu0N1S1F9KuZ3n//ff7295CVZhA1K6pa9sQvta2bv5Qz+XSSy/13q6uK/8sBzvNJWLPUnXEJPJQz6VVUQ+6sWdZrmu5tGKXXXZxruqFWl60sGG8V7EH3fdbvrNQLGKxnJ2zUTt0zESoqMJNfm622WaF5VC9/aeccorb13bkHa8Rv9vF9IsvvihWW201P1fnRy5iU+5Z6p4SI+1XncMOO6ywF028RNNvy2973a+//nqa4+pZxuvFUZK2y/dz+ST1YnW8sWcZ69jLo7jssstq8dfo6sknn4yH+c6UgPKOHUsUyy233NKFQeKgoZNuqCiWb7/9tm9LsMrDcg2NVE83YGNp92CV67YSy59++skfKImG0gUqGqJqqKprqr3dLpYXqz0k1rOoXbfZdaJY6mH6/fffvW3WO2qbUugklvE6NoFR2MSR+yn/xd96sL59/fXXezW90C644AL/LT5i8tRTTxV95aYXg86VeClmKko1SPwaS7uY6gUqO5Yb9KGy5RML8dC+KJbW8/Nt7TvzzDOLb775pvES02wr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" width="331" height="126" class="img_ev3q"></p><p>Again, it is displayed as plain text instead of HTML.</p><p>You might think that the browser&#x27;s MIME sniffing mechanism is a mystery, like a black box that you don&#x27;t know how it works. Fortunately, we are testing with Chrome, and Chromium is open source.</p><p>The code responsible for MIME sniffing in Chromium can be found in <a href="https://source.chromium.org/chromium/chromium/src/+/refs/tags/118.0.5981.4:net/base/mime_sniffer.cc" target="_blank" rel="noopener noreferrer">net/base/mime_sniffer.cc</a>. At the beginning of the code, it explains how the detection works:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Detecting mime types is a tricky business because we need to balance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// compatibility concerns with security issues.  Here is a survey of how other</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// browsers behave and then a description of how we intend to behave.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// HTML payload, no Content-Type header:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * IE 7: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Firefox 2: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Safari 3: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Opera 9: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Here the choice seems clear:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; Chrome: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// HTML payload, Content-Type: &quot;text/plain&quot;:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * IE 7: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Firefox 2: Render as text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Safari 3: Render as text (Note: Safari will Render as HTML if the URL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//                                   has an HTML extension)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Opera 9: Render as text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Here we choose to follow the majority (and break some compatibility with IE).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Many folks dislike IE&#x27;s behavior here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; Chrome: Render as text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// We generalize this as follows.  If the Content-Type header is text/plain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// we won&#x27;t detect dangerous mime types (those that can execute script).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// HTML payload, Content-Type: &quot;application/octet-stream&quot;:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * IE 7: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Firefox 2: Download as application/octet-stream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Safari 3: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// * Opera 9: Render as HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// We follow Firefox.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; Chrome: Download as application/octet-stream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// One factor in this decision is that IIS 4 and 5 will send</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// application/octet-stream for .xhtml files (because they don&#x27;t recognize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// the extension).  We did some experiments and it looks like this doesn&#x27;t occur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// very often on the web.  We choose the more secure option.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So, what makes it consider the payload as &quot;HTML payload&quot;? It is checked further down in the code:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Our HTML sniffer differs slightly from Mozilla.  For example, Mozilla will</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// decide that a document that begins &quot;&lt;!DOCTYPE SOAP-ENV:Envelope PUBLIC &quot; is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// HTML, but we will not.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">tag</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">  </span><span class="token macro property expression function" style="color:#d73a49">MAGIC_STRING</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property string" style="color:#e3116c">&quot;text/html&quot;</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;&lt;&quot;</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">tag</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> MagicNumber kSniffableTags</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// XML processing directive.  Although this is not an HTML mime type, we sniff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// for this in the HTML phase because text/xml is just as powerful as HTML and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// we want to leverage our white space skipping technology.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_NUMBER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;text/xml&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;?xml&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// DOCTYPEs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!DOCTYPE html&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// HTML5 spec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Sniffable tags, ordered by how often they occur in sniffable documents.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;script&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// HTML5 spec, Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;html&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// HTML5 spec, Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!--&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;head&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// HTML5 spec, Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iframe&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;h1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;div&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;font&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;table&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;body&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;br&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">MAGIC_HTML_TAG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;p&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Mozilla</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Returns true and sets result if the content appears to be HTML.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Clears have_enough_content if more data could possibly change the result.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bool</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SniffForHTML</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">StringPiece content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token keyword" style="color:#00009f">bool</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> have_enough_content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// For HTML, we are willing to consider up to 512 bytes. This may be overly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// conservative as IE only considers 256.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">have_enough_content </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">TruncateStringPiece</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// We adopt a strategy similar to that used by Mozilla to sniff HTML tags,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// but with some modifications to better match the HTML5 spec.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  base</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">StringPiece trimmed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      base</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">TrimWhitespaceASCII</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> base</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TRIM_LEADING</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// |trimmed| now starts at first non-whitespace character (or is empty).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CheckForMagicNumbers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">trimmed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kSniffableTags</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It checks if the string at the beginning of the response, after removing whitespace, matches the HTML patterns listed above. The common HTML beginnings, such as <code>&lt;!DOCTYPE html</code> and <code>&lt;html</code>, are included. This also explains why only the example <code>&lt;h1&gt;hello&lt;/h1&gt;</code> is rendered as HTML in our previous tests.</p><p>From the source code, it seems that Chromium does not consider the file extension or other factors in the URL. It solely relies on the file content. Let&#x27;s do another test to verify this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/test.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abcde&lt;h1&gt;test&lt;/h1&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5555</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Server is running on port 5555&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I won&#x27;t include an image here, but regardless of the URL being <code>test.html</code>, the result is still displayed as plain text. What about other browsers? Let&#x27;s try opening it with Firefox:</p><p><img loading="lazy" src="/beyond-xss/en/assets/images/28-04-f88ade6dda3ce4eaa33508591626e600.png" width="454" height="208" class="img_ev3q"></p><p>We can see that Firefox actually renders it as HTML! Therefore, we can infer that Firefox considers the file extension in the URL when performing MIME sniffing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploiting-mime-sniffing-for-attacks">Exploiting MIME Sniffing for Attacks<a href="#exploiting-mime-sniffing-for-attacks" class="hash-link" aria-label="Direct link to Exploiting MIME Sniffing for Attacks" title="Direct link to Exploiting MIME Sniffing for Attacks">​</a></h2><p>From our previous research, we have confirmed a fact: if a response does not have a <code>Content-Type</code> set and we can control the content, we can use MIME sniffing to make the browser interpret the file as a webpage.</p><p>For example, let&#x27;s assume there is an image upload feature that only checks the file extension but not the content. We can upload a file named <code>a.png</code>, but the content is <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>. If the server does not automatically add the <code>Content-Type</code> when serving this image, it becomes an XSS vulnerability.</p><p>However, most servers nowadays automatically add the <code>Content-Type</code>. Is it still possible?</p><p>Yes, we can combine it with other minor issues.</p><p>Apache HTTP Server is a commonly used server, and the famous LAMP stack (Linux + Apache + MySQL + PHP) uses this server.</p><p>Apache HTTP Server has a peculiar behavior: if the filename contains only a dot (<code>.</code>), it will not output the <code>Content-Type</code>. For example, <code>a.png</code> will automatically detect the MIME type based on the file extension and output <code>image/png</code>, but if the filename is <code>..png</code>, it will not output the <code>Content-Type</code>.</p><p>Therefore, if the backend uses Apache HTTP Server to handle file downloads, we can upload a seemingly legitimate image with the extension <code>..png</code>, but when opened in a browser, it will be displayed as a webpage, becoming an XSS vulnerability.</p><p>According to Apache HTTP Server, this is an expected behavior, and you can refer to <a href="https://twitter.com/YNizry/status/1582733545759330306" target="_blank" rel="noopener noreferrer">@YNizry</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="content-types-that-can-execute-javascript">Content Types that can execute JavaScript<a href="#content-types-that-can-execute-javascript" class="hash-link" aria-label="Direct link to Content Types that can execute JavaScript" title="Direct link to Content Types that can execute JavaScript">​</a></h2><p>Besides HTML files, what other file types can execute JavaScript?</p><p>In the research conducted by BlackFan in 2020: <a href="https://github.com/BlackFan/content-type-research/tree/master" target="_blank" rel="noopener noreferrer">Content-Type Research</a>, a comprehensive list is provided: <a href="https://github.com/BlackFan/content-type-research/blob/master/XSS.md" target="_blank" rel="noopener noreferrer">Content-Type that can be used for XSS</a>.</p><p>From the list, we can see that besides HTML, XML and SVG are the most common content types that can execute JavaScript.</p><p>Of particular interest here is SVG files because many websites have image upload functionality, and SVG is considered an image format. Therefore, some websites allow SVG uploads. However, from this research, we can learn that allowing SVG uploads is equivalent to allowing HTML uploads since SVG can execute JavaScript!</p><p>For example, febin reported a vulnerability to the open-source software Mantis Bug Tracker in 2022: <a href="https://mantisbt.org/bugs/view.php?id=30384" target="_blank" rel="noopener noreferrer">CVE-2022-33910: Stored XSS via SVG file upload</a>. This vulnerability occurred because users could upload files when creating a new issue, and the file format allowed was SVG. Therefore, a malicious SVG file could be uploaded, and when other users opened it, the hidden code inside would be executed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="content-types-that-can-be-loaded-as-scripts">Content Types that can be loaded as scripts<a href="#content-types-that-can-be-loaded-as-scripts" class="hash-link" aria-label="Direct link to Content Types that can be loaded as scripts" title="Direct link to Content Types that can be loaded as scripts">​</a></h2><p>Take the following code snippet as an example:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">URL</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Have you ever wondered what the content type of <code>URL</code> should be for the browser to load it as a script?</p><p>For instance, if it is <code>image/png</code>, it won&#x27;t work, and you will see the following error message in the browser:</p><blockquote><p>Refused to execute script from &#x27;http://localhost:5555/js&#x27; because its MIME type (&#x27;image/png&#x27;) is not executable.</p></blockquote><p>The most common one, <code>text/javascript</code>, obviously works fine. But are there any others?</p><p>Out of the ten content types listed below, only two of them won&#x27;t work. Can you guess which two?</p><ol><li>application/zip</li><li>application/json</li><li>application/octet-stream</li><li>text/csv</li><li>text/html</li><li>text/json</li><li>text/plain</li><li>huli/blog</li><li>video/mp4</li><li>font/woff2</li></ol><p>We will reveal the answer later, but first, let&#x27;s reveal the &quot;valid JavaScript MIME types&quot; written in the Chromium source code: <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/tags/103.0.5012.1/third_party/blink/common/mime_util/mime_util.cc" target="_blank" rel="noopener noreferrer">/third_party/blink/common/mime_util/mime_util.cc</a>:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//  Support every script type mentioned in the spec, as it notes that &quot;User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//  agents must recognize all JavaScript MIME types.&quot; See</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//  https://html.spec.whatwg.org/#javascript-mime-type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> kSupportedJavascriptTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;application/ecmascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;application/javascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;application/x-ecmascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;application/x-javascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/ecmascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/javascript1.5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/jscript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/livescript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/x-ecmascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text/x-javascript&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above are all valid JavaScript MIME types, and you can see many remnants of the past, such as <code>jscript</code> or <code>livescript</code>.</p><p>Apart from the valid JavaScript MIME types, according to the specification, there are only four types that won&#x27;t work:</p><ol><li><code>audio/*</code></li><li><code>image/*</code></li><li><code>video/*</code></li><li><code>text/csv</code></li></ol><p>Except for these, all other types are valid. Therefore, among the options mentioned above, only <code>text/csv</code> and <code>video/mp4</code> won&#x27;t work, while the rest will work! Yes, even <code>text/html</code> and <code>application/json</code> will work, and even <code>huli/blog</code> will work.</p><p>If you want to tighten this lenient mechanism and only allow JavaScript MIME types to load, you can add a header in the response: <code>X-Content-Type-Options: nosniff</code>. After adding this header, none of the 10 examples mentioned earlier will work, and you will see the following error when loading:</p><blockquote><p>Refused to execute script from &#x27;http://localhost:5555/js&#x27; because its MIME type (&#x27;text/plain&#x27;) is not executable, and strict MIME type checking is enabled.</p></blockquote><p><code>strict MIME type</code> is the feature enabled by adding that header.</p><p>The same applies to stylesheets. After enabling this feature, only the <code>text/css</code> MIME type will be recognized as valid, and all others will result in an error.</p><p>So, what happens if you continue to enable this feature? It introduces an additional security risk.</p><p>Let&#x27;s say you happen to find an XSS vulnerability on a website. However, the problem is that the website&#x27;s CSP is <code>script-src &#x27;self&#x27;;</code>, which means it doesn&#x27;t allow any external scripts to be loaded and inline scripts are also blocked. How can you bypass the CSP in this case?</p><p>If the website provides a file upload feature that accepts files other than images, videos, and CSV files, and doesn&#x27;t check the content, let&#x27;s say it only accepts ZIP files, then you can upload a file that contains JavaScript code.</p><p>In this way, you can use <code>&lt;script src=&quot;/uploads/files/my.zip&quot;&gt;&lt;/script&gt;</code> to load the script and successfully bypass the CSP. The reason this works is because of the behavior mentioned earlier – as long as the MIME type is not one of those few types, it can be loaded as a script.</p><p>That&#x27;s why you see many websites adding this header, to prevent such behavior.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>In this article, we have seen many interesting things related to MIME types and also looked at a lot of Chromium source code. Personally, I find that Chromium&#x27;s source code is written very clearly and includes comments and links to specifications, so you don&#x27;t need to search for specifications separately. It&#x27;s like killing two birds with one stone.</p><p>Finally, we introduced the purpose and function of the <code>X-Content-Type-Options: nosniff</code> header. I believe many people have seen this header before but didn&#x27;t know what it was for, and now you know.</p><p>References:</p><ol><li><a href="https://blog.huli.tw/2022/08/01/en/uiuctf-2022-writeup/" target="_blank" rel="noopener noreferrer">UIUCTF 2022 Write-up</a></li><li><a href="https://blog.huli.tw/2022/04/24/en/script-type/" target="_blank" rel="noopener noreferrer">What do you know about script type?</a></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/beyond-xss/en/ch5/clickjacking/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">What You See Is Not What You Get: Clickjacking</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/beyond-xss/en/ch5/supply-chain-attack/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Frontend Supply Chain Attacks: Attacking Downstream from Upstream</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mime-sniffing-101" class="table-of-contents__link toc-highlight">MIME Sniffing 101</a></li><li><a href="#exploiting-mime-sniffing-for-attacks" class="table-of-contents__link toc-highlight">Exploiting MIME Sniffing for Attacks</a></li><li><a href="#content-types-that-can-execute-javascript" class="table-of-contents__link toc-highlight">Content Types that can execute JavaScript</a></li><li><a href="#content-types-that-can-be-loaded-as-scripts" class="table-of-contents__link toc-highlight">Content Types that can be loaded as scripts</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Huli. All rights reserved. Built with Docusaurus.</div></div></div></footer></div>
<script src="/beyond-xss/en/assets/js/runtime~main.f929a1ae.js"></script>
<script src="/beyond-xss/en/assets/js/main.3cee423b.js"></script>
</body>
</html>